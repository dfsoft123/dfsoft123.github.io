<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ–çŸ¿æ¸¸æˆ</title>
    <style>
        :root {
            --primary-color: #2196F3;
            --secondary-color: #4CAF50;
            --accent-color: #FF9800;
            --danger-color: #f44336;
            --dark-color: #333;
            --light-color: #f5f5f5;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
    </style>
    
    <script>
        // æˆå°±ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘
        (function() {
            // æˆå°±ç±»å‹å®šä¹‰
            const achievementTypes = {
                // èµ„æºç±»æˆå°±
                gold: { name: 'é‡‘å¸æ”¶é›†è€…', description: 'æ”¶é›†{value}é‡‘å¸', category: 'resources' },
                alchemyPoints: { name: 'ç‚¼è¯å¸ˆ', description: 'è·å¾—{value}ç‚¼è¯å€¼', category: 'resources' },
                alchemyCrystals: { name: 'ç»“æ™¶å¤§å¸ˆ', description: 'è·å¾—{value}ç‚¼è¯ç»“æ™¶', category: 'resources' },
                iridiumIngots: { name: 'é“±çŸ¿çŸ¿å·¥', description: 'è·å¾—{value}é“±é”­', category: 'resources' },
                hassiumIngots: { name: 'ğ¬­¶çŸ¿çŸ¿å·¥', description: 'è·å¾—{value}ğ¬­¶é”­', category: 'resources' },
                singularity: { name: 'å¥‡ç‚¹æ”¶é›†è€…', description: 'è·å¾—{value}å¥‡ç‚¹', category: 'resources' },
                matter: { name: 'ç‰©è´¨æ“æ§è€…', description: 'è·å¾—{value}ç‰©è´¨', category: 'resources' },
                energy: { name: 'èƒ½é‡æŒæ§è€…', description: 'è·å¾—{value}èƒ½é‡', category: 'resources' },
                productionCore: { name: 'æ ¸å¿ƒç”Ÿäº§è€…', description: 'è·å¾—{value}é‡äº§æ ¸å¿ƒ', category: 'resources' },
                endCore: { name: 'ç»ˆç„‰ä½¿è€…', description: 'è·å¾—{value}ç»ˆç„‰æ ¸å¿ƒ', category: 'resources' },
                
                // å±æ€§ç±»æˆå°±
                usageBonus: { name: 'ä½¿ç”¨å¤§å¸ˆ', description: 'è¾¾åˆ°{value}ä½¿ç”¨å¢ç›Š', category: 'stats' },
                alchemyBonus: { name: 'ç‚¼è¯å¢å¼º', description: 'è¾¾åˆ°{value}ç‚¼è¯å¢ç›Š', category: 'stats' },
                energyMultiplier: { name: 'èƒ½é‡å€å¢', description: 'è¾¾åˆ°{value}èƒ½é‡å€é€Ÿ', category: 'stats' },
                
                // æ·¬ç‚¼å±æ€§æˆå°±
                damageBonus: { name: 'ä¼¤å®³å¼ºåŒ–', description: 'è¾¾åˆ°{value}%ä¼¤å®³å¢ç›Š', category: 'stats', path: 'forgingStats.damageBonus' },
                usageBonusGain: { name: 'ä½¿ç”¨å¢ç›Šè·å–', description: 'è¾¾åˆ°{value}%ä½¿ç”¨å¢ç›Šè·å–', category: 'stats', path: 'forgingStats.usageBonusGain' },
                goldGain: { name: 'é‡‘å¸è·å–å¢å¼º', description: 'è¾¾åˆ°{value}%é‡‘å¸è·å–', category: 'stats', path: 'forgingStats.goldGain' },
                crystalBonusGain: { name: 'ç»“æ™¶å¢ç›Šè·å–', description: 'è¾¾åˆ°{value}%ç»“æ™¶å¢ç›Šè·å–', category: 'stats', path: 'forgingStats.crystalBonusGain' },
                
                // é•¶åµŒæˆå°±
                embedding1: { name: 'æ”»å‡»é•¶åµŒå¤§å¸ˆ', description: 'æ”»å‡»å¢ç›Šé•¶åµŒè¾¾åˆ°{value}ä¸ª', category: 'stats', path: 'embeddingBlocks[0].count' },
                embedding2: { name: 'ç‚¼è¯å€¼é•¶åµŒå¤§å¸ˆ', description: 'ç‚¼è¯å€¼è·å–å¢ç›Šé•¶åµŒè¾¾åˆ°{value}ä¸ª', category: 'stats', path: 'embeddingBlocks[1].count' },
                embedding3: { name: 'ä½¿ç”¨å¢ç›Šé•¶åµŒå¤§å¸ˆ', description: 'ä½¿ç”¨å¢ç›Šè·å–å¢ç›Šé•¶åµŒè¾¾åˆ°{value}ä¸ª', category: 'stats', path: 'embeddingBlocks[2].count' },
                embedding4: { name: 'é‡‘å¸é•¶åµŒå¤§å¸ˆ', description: 'é‡‘å¸è·å–å¢ç›Šé•¶åµŒè¾¾åˆ°{value}ä¸ª', category: 'stats', path: 'embeddingBlocks[3].count' },
                embedding5: { name: 'å…¨å±æ€§é•¶åµŒå¤§å¸ˆ', description: 'å…¨å±æ€§å¢ç›Šé•¶åµŒè¾¾åˆ°{value}ä¸ª', category: 'stats', path: 'embeddingBlocks[4].count' },
                
                // æŒ–çŸ¿ç±»æˆå°±
                miningCount: { name: 'æŒ–çŸ¿å¤§å¸ˆ', description: 'ç´¯è®¡æŒ–çŸ¿{value}æ¬¡', category: 'mining' },
                miningPerSecond: { name: 'æŒ–çŸ¿æ•ˆç‡', description: 'è¾¾åˆ°æ¯ç§’æŒ–çŸ¿{value}æ¬¡', category: 'mining' },
                ownedPickaxes: { name: 'æ”¶è—å®¶', description: 'æ‹¥æœ‰{value}æŠŠé•å­', category: 'mining', getValue: function() { return gameData.ownedPickaxes.length; } }
            };
            
            // ç”Ÿæˆæˆå°±ç›®æ ‡å€¼ï¼ˆä»1e4å¼€å§‹ï¼Œæ¯æ¬¡ä¹˜ä»¥1e4ï¼Œå…±77ä¸ªï¼‰
            function generateAchievementValues() {
                const values = [];
                let currentValue = 10000; // 1e4
                for (let i = 0; i < 77; i++) {
                    values.push(currentValue);
                    currentValue *= 10000; // æ¯æ¬¡ä¹˜ä»¥1e4
                }
                return values;
            }
            
            // è·å–æ•°æ®è·¯å¾„çš„å€¼
            function getValueByPath(obj, path) {
                if (path.includes('.')) {
                    const parts = path.split('.');
                    let current = obj;
                    for (let part of parts) {
                        if (part.includes('[')) {
                            const key = part.match(/(\w+)\[(\d+)\]/);
                            if (key) {
                                current = current[key[1]][parseInt(key[2])];
                            }
                        } else {
                            current = current[part];
                        }
                    }
                    return current;
                } else if (path.includes('[')) {
                    const key = path.match(/(\w+)\[(\d+)\]/);
                    if (key) {
                        return obj[key[1]][parseInt(key[2])];
                    }
                }
                return obj[path];
            }
            
            // æ ¼å¼åŒ–å¤§æ•°å­—
            function formatAchievementValue(value) {
                const suffixes = ['', 'ä¸‡', 'äº¿', 'å…†', 'äº¬', 'å“', 'ç§­', 'ç©°', 'æ²Ÿ', 'æ¶§', 'æ­£', 'è½½', 'æ', 'æ’æ²³æ²™', 'é˜¿åƒ§ç¥‡', 'é‚£ç”±ä»–', 'ä¸å¯æ€è®®', 'æ— é‡å¤§æ•°', 'åæ— é‡æ•°', 'ç™¾æ— é‡æ•°', 'åƒæ— é‡æ•°', 'ä¸‡æ— é‡æ•°', 'äº¿æ— é‡æ•°', 'å…†æ— é‡æ•°', 'äº¬æ— é‡æ•°', 'å“æ— é‡æ•°', 'ç§­æ— é‡æ•°', 'ç©°æ— é‡æ•°', 'æ²Ÿæ— é‡æ•°', 'æ¶§æ— é‡æ•°', 'æ­£æ— é‡æ•°', 'è½½æ— é‡æ•°', 'ææ— é‡æ•°', 'æ’æ²³æ²™æ— é‡æ•°', 'é˜¿åƒ§ç¥‡æ— é‡æ•°', 'é‚£ç”±ä»–æ— é‡æ•°', 'ä¸å¯æ€è®®æ— é‡æ•°', 'æ— é‡å¤§æ•°æ— é‡æ•°', 'åæ— é‡å¤§æ•°æ— é‡æ•°', 'ç™¾æ— é‡å¤§æ•°æ— é‡æ•°', 'åƒæ— é‡å¤§æ•°æ— é‡æ•°', 'ä¸‡æ— é‡å¤§æ•°æ— é‡æ•°', 'äº¿æ— é‡å¤§æ•°æ— é‡æ•°', 'å…†æ— é‡å¤§æ•°æ— é‡æ•°', 'äº¬æ— é‡å¤§æ•°æ— é‡æ•°', 'å“æ— é‡å¤§æ•°æ— é‡æ•°', 'ç§­æ— é‡å¤§æ•°æ— é‡æ•°', 'ç©°æ— é‡å¤§æ•°æ— é‡æ•°', 'æ²Ÿæ— é‡å¤§æ•°æ— é‡æ•°', 'æ¶§æ— é‡å¤§æ•°æ— é‡æ•°', 'æ­£æ— é‡å¤§æ•°æ— é‡æ•°', 'è½½æ— é‡å¤§æ•°æ— é‡æ•°', 'ææ— é‡å¤§æ•°æ— é‡æ•°', 'æ’æ²³æ²™æ— é‡å¤§æ•°æ— é‡æ•°', 'é˜¿åƒ§ç¥‡æ— é‡å¤§æ•°æ— é‡æ•°', 'é‚£ç”±ä»–æ— é‡å¤§æ•°æ— é‡æ•°', 'ä¸å¯æ€è®®æ— é‡å¤§æ•°æ— é‡æ•°', 'æ— é‡å¤§æ•°æ— é‡å¤§æ•°æ— é‡æ•°', 'å…ƒ', 'å…ƒä¸‡', 'å…ƒäº¿', 'å…ƒå…†', 'å…ƒäº¬', 'å…ƒå“', 'å…ƒç§­', 'å…ƒç©°', 'å…ƒæ²Ÿ', 'å…ƒæ¶§', 'å…ƒæ­£', 'å…ƒè½½', 'å…ƒæ', 'å…ƒæ’æ²³æ²™', 'å…ƒé˜¿åƒ§ç¥‡', 'å…ƒé‚£ç”±ä»–', 'å…ƒä¸å¯æ€è®®', 'å…ƒåï¼ˆé€šå…³ï¼ï¼‰'];
                
                if (value === 0) return '0';
                
                let suffixIndex = 0;
                let currentValue = value;
                
                while (currentValue >= 10000 && suffixIndex < suffixes.length - 1) {
                    currentValue /= 10000;
                    suffixIndex++;
                }
                
                if (currentValue >= 1000) {
                    return currentValue.toFixed(0) + suffixes[suffixIndex];
                } else if (currentValue >= 100) {
                    return currentValue.toFixed(1) + suffixes[suffixIndex];
                } else if (currentValue >= 10) {
                    return currentValue.toFixed(2) + suffixes[suffixIndex];
                } else {
                    return currentValue.toFixed(3) + suffixes[suffixIndex];
                }
            }
            
            // ç”Ÿæˆæ‰€æœ‰æˆå°±
            function generateAchievements() {
                const achievements = [];
                const targetValues = generateAchievementValues();
                
                Object.entries(achievementTypes).forEach(([key, config]) => {
                    targetValues.forEach((target, index) => {
                        // å¯¹äºç™¾åˆ†æ¯”ç±»å‹çš„æˆå°±ï¼Œç‰¹æ®Šå¤„ç†
                        const isPercentage = ['damageBonus', 'usageBonusGain', 'goldGain', 'crystalBonusGain'].includes(key);
                        const formattedTarget = isPercentage ? Math.floor(target / 100) : formatAchievementValue(target);
                        
                        achievements.push({
                            id: `${key}_${index}`,
                            type: key,
                            target: target,
                            name: `${config.name} ${index + 1}`,
                            description: config.description.replace('{value}', formattedTarget),
                            category: config.category,
                            path: config.path,
                            getValue: config.getValue,
                            completed: false,
                            progress: 0
                        });
                    });
                });
                
                return achievements;
            }
            
            // åˆå§‹åŒ–æˆå°±ç³»ç»Ÿ
            function initAchievements() {
                // å¦‚æœæˆå°±æœªåˆå§‹åŒ–ï¼Œç”Ÿæˆæ–°çš„æˆå°±åˆ—è¡¨
                if (!gameData.achievements || gameData.achievements.length === 0) {
                    gameData.achievements = generateAchievements();
                }
                
                // åˆå§‹åŒ–å·²å®Œæˆæˆå°±è®°å½•
                if (!gameData.completedAchievements) {
                    gameData.completedAchievements = {};
                }
                
                // æ›´æ–°æˆå°±åˆ—è¡¨æ˜¾ç¤º
                updateAchievementsList();
                
                // ç»‘å®šæˆå°±ç³»ç»Ÿäº‹ä»¶
                bindAchievementEvents();
            }
            
            // ç»‘å®šæˆå°±ç³»ç»Ÿäº‹ä»¶
            function bindAchievementEvents() {
                // æ ‡ç­¾é¡µåˆ‡æ¢
                document.getElementById('achievements-tab').addEventListener('click', () => {
                    showAchievements();
                });
                
                // åˆ†ç±»ç­›é€‰æŒ‰é’®
                document.getElementById('achievement-category-all').addEventListener('click', () => {
                    filterAchievements('all');
                });
                
                document.getElementById('achievement-category-resources').addEventListener('click', () => {
                    filterAchievements('resources');
                });
                
                document.getElementById('achievement-category-stats').addEventListener('click', () => {
                    filterAchievements('stats');
                });
                
                document.getElementById('achievement-category-mining').addEventListener('click', () => {
                    filterAchievements('mining');
                });
                
                document.getElementById('achievement-category-completed').addEventListener('click', () => {
                    filterAchievements('completed');
                });
                
                // æœç´¢åŠŸèƒ½
                document.getElementById('achievement-search').addEventListener('input', () => {
                    const searchTerm = document.getElementById('achievement-search').value.toLowerCase();
                    searchAchievements(searchTerm);
                });
            }
            
            // æ˜¾ç¤ºæˆå°±ç³»ç»Ÿ
            function showAchievements() {
                // éšè—æ‰€æœ‰å…¶ä»–ç³»ç»Ÿ
                document.querySelectorAll('.mining-area, .alchemy-system, .forging-system, .embedding-system').forEach(el => {
                    el.style.display = 'none';
                });
                
                // æ˜¾ç¤ºæˆå°±ç³»ç»Ÿ
                document.getElementById('achievements-system').style.display = 'block';
                
                // æ›´æ–°æ ‡ç­¾é¡µçŠ¶æ€
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                document.getElementById('achievements-tab').classList.add('active');
                
                // æ›´æ–°æˆå°±åˆ—è¡¨
                updateAchievementsList();
            }
            
            // æ›´æ–°æˆå°±åˆ—è¡¨æ˜¾ç¤º
            function updateAchievementsList() {
                const achievementsList = document.getElementById('achievements-list');
                achievementsList.innerHTML = '';
                
                let completedCount = 0;
                
                gameData.achievements.forEach(achievement => {
                    const achievementElement = document.createElement('div');
                    achievementElement.className = `achievement-item ${achievement.completed ? 'completed' : ''}`;
                    
                    // æ·»åŠ æˆå°±å¾½ç« 
                    const badge = document.createElement('div');
                    badge.className = `achievement-badge ${achievement.completed ? 'completed' : 'pending'}`;
                    badge.textContent = achievement.completed ? 'âœ“' : ' ';
                    achievementElement.appendChild(badge);
                    
                    // æ·»åŠ æˆå°±æ ‡é¢˜
                    const title = document.createElement('div');
                    title.className = 'achievement-title';
                    title.textContent = achievement.name;
                    achievementElement.appendChild(title);
                    
                    // æ·»åŠ æˆå°±æè¿°
                    const description = document.createElement('div');
                    description.className = 'achievement-description';
                    description.textContent = achievement.description;
                    achievementElement.appendChild(description);
                    
                    // æ·»åŠ æˆå°±è¿›åº¦
                    const progress = document.createElement('div');
                    progress.className = 'achievement-progress';
                    progress.textContent = `è¿›åº¦: ${formatAchievementValue(achievement.progress)} / ${formatAchievementValue(achievement.target)}`;
                    achievementElement.appendChild(progress);
                    
                    achievementsList.appendChild(achievementElement);
                    
                    if (achievement.completed) {
                        completedCount++;
                    }
                });
                
                // æ›´æ–°æˆå°±ç»Ÿè®¡
                document.getElementById('completed-achievements-count').textContent = completedCount;
                document.getElementById('total-achievements-count').textContent = gameData.achievements.length;
            }
            
            // ç­›é€‰æˆå°±
            function filterAchievements(category) {
                const achievementItems = document.querySelectorAll('.achievement-item');
                
                achievementItems.forEach((item, index) => {
                    const achievement = gameData.achievements[index];
                    let show = true;
                    
                    if (category === 'all') {
                        show = true;
                    } else if (category === 'completed') {
                        show = achievement.completed;
                    } else {
                        show = achievement.category === category;
                    }
                    
                    item.style.display = show ? 'block' : 'none';
                });
            }
            
            // æœç´¢æˆå°±
            function searchAchievements(searchTerm) {
                const achievementItems = document.querySelectorAll('.achievement-item');
                
                achievementItems.forEach((item, index) => {
                    const achievement = gameData.achievements[index];
                    const matches = achievement.name.toLowerCase().includes(searchTerm) || 
                                  achievement.description.toLowerCase().includes(searchTerm);
                    
                    item.style.display = matches ? 'block' : 'none';
                });
            }
            
            // æ£€æŸ¥æˆå°±è¿›åº¦
            function checkAchievements() {
                let hasNewAchievements = false;
                
                gameData.achievements.forEach(achievement => {
                    if (!achievement.completed) {
                        let currentValue = 0;
                        
                        // è·å–å½“å‰å€¼
                        if (achievement.getValue) {
                            currentValue = achievement.getValue();
                        } else if (achievement.path) {
                            currentValue = getValueByPath(gameData, achievement.path);
                        } else {
                            currentValue = gameData[achievement.type] || 0;
                        }
                        
                        // å¯¹äºç™¾åˆ†æ¯”ç±»å‹çš„æˆå°±ï¼Œç‰¹æ®Šå¤„ç†
                        const isPercentage = ['damageBonus', 'usageBonusGain', 'goldGain', 'crystalBonusGain'].includes(achievement.type);
                        if (isPercentage) {
                            currentValue *= 100; // è½¬æ¢ä¸ºç™¾åˆ†æ¯”
                        }
                        
                        // æ›´æ–°è¿›åº¦
                        achievement.progress = currentValue;
                        
                        // æ£€æŸ¥æ˜¯å¦å®Œæˆ
                        if (currentValue >= achievement.target) {
                            achievement.completed = true;
                            gameData.completedAchievements[achievement.id] = true;
                            hasNewAchievements = true;
                            
                            // è§¦å‘æˆå°±è§£é”åŠ¨ç”»
                            unlockAchievement(achievement);
                        }
                    }
                });
                
                // å¦‚æœæœ‰æ–°æˆå°±ï¼Œæ›´æ–°UI
                if (hasNewAchievements) {
                    updateAchievementsList();
                }
            }
            
            // è§£é”æˆå°±åŠ¨ç”»
            function unlockAchievement(achievement) {
                // åˆ›å»ºä¸´æ—¶é€šçŸ¥
                const notification = document.createElement('div');
                notification.className = 'achievement-unlock';
                notification.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background-color: var(--secondary-color);
                    color: white;
                    padding: 20px;
                    border-radius: var(--border-radius);
                    font-size: 18px;
                    font-weight: bold;
                    z-index: 1001;
                    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
                    text-align: center;
                    min-width: 300px;
                `;
                
                notification.innerHTML = `
                    <div style="font-size: 14px; margin-bottom: 5px;">ğŸ† æˆå°±è§£é”ï¼</div>
                    <div style="font-size: 18px; font-weight: bold; margin-bottom: 5px;">${achievement.name}</div>
                    <div style="font-size: 14px;">${achievement.description}</div>
                `;
                
                document.body.appendChild(notification);
                
                // 2ç§’åç§»é™¤é€šçŸ¥
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transition = 'opacity 0.5s ease';
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 500);
                }, 2000);
            }
            
            // æ‰©å±•ç°æœ‰å‡½æ•°ä»¥é›†æˆæˆå°±æ£€æŸ¥
            const originalUpdateStats = window.updateStats || function() {};
            window.updateStats = function() {
                originalUpdateStats();
                checkAchievements();
            };
            
            // å¯¼å‡ºæˆå°±ç³»ç»Ÿå‡½æ•°åˆ°å…¨å±€
            window.initAchievements = initAchievements;
            window.checkAchievements = checkAchievements;
            window.showAchievements = showAchievements;
        })();
        
        // åˆå§‹åŒ–æˆå°±ç³»ç»Ÿå°†åœ¨gameDataå®šä¹‰åè°ƒç”¨
    </script>
    
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            margin: 0;
            padding: 20px;
            color: #333;
            min-height: 100vh;
        }
        
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            backdrop-filter: blur(10px);
        }
        
        h1 {
            color: var(--dark-color);
            margin-bottom: 25px;
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* ç»Ÿè®¡ä¿¡æ¯é¢æ¿ä¼˜åŒ– */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stats-group {
            background: var(--light-color);
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary-color);
        }
        
        .stats-group.resources {
            border-left-color: var(--secondary-color);
        }
        
        .stats-group.advanced {
            border-left-color: var(--accent-color);
        }
        
        .stats-group h3 {
            margin-top: 0;
            margin-bottom: 12px;
            font-size: 1.1rem;
            color: var(--dark-color);
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        
        .stat-label {
            font-weight: 500;
            color: #555;
        }
        
        .stat-value {
            font-weight: 600;
            color: var(--dark-color);
        }
        
        #auto-save-status {
            color: var(--secondary-color);
            font-weight: 600;
        }
        
        /* ç³»ç»Ÿæ ‡ç­¾é¡µä¼˜åŒ– */
        .system-tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 25px 0;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 12px 24px;
            font-size: 16px;
            background-color: var(--light-color);
            color: var(--dark-color);
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .tab-btn:hover {
            background-color: #e0e0e0;
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 4px 8px rgba(33, 150, 243, 0.3);
        }
        
        /* æŒ–çŸ¿åŒºåŸŸä¼˜åŒ– */
        .mining-area {
            background: linear-gradient(145deg, #f0f0f0, #e0e0e0);
            padding: 25px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            box-shadow: var(--box-shadow);
        }
        
        .block-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 12px 20px;
            font-size: 16px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .control-btn:hover {
            background-color: #1976D2;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        .control-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .mine-block {
            width: 280px;
            height: 280px;
            margin: 20px auto;
            border: 4px solid #666;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            transition: transform 0.1s;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .mine-block:hover {
            transform: scale(1.03);
        }
        
        .mine-block:active {
            transform: scale(0.98);
        }
        
        .block-level {
            font-size: 11.25px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #ffffff;
            text-shadow: 1px 1px 3px #000000;
        }
        
        .health-bar {
            width: 80%;
            height: 20px;
            background-color: #ddd;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .health-fill {
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #8BC34A);
            transition: width 0.3s ease;
        }
        
        .block-health {
            font-size: 10px;
            color: #ffffff;
            text-shadow: 1px 1px 2px #000000;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .block-reward {
            font-size: 8.75px;
            color: #ffffff;
            text-shadow: 1px 1px 2px #000000;
            font-weight: bold;
            max-width: 90%;
            line-height: 1.4;
        }
        
        /* é•å­å•†åº—ä¼˜åŒ– */
        .pickaxe-shop {
            margin-top: 30px;
            padding: 25px;
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .shop-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--dark-color);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            display: inline-block;
        }
        
        .pickaxe-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .pickaxe-item {
            padding: 20px;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            text-align: center;
            transition: var(--transition);
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .pickaxe-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .pickaxe-item.owned {
            border-color: var(--secondary-color);
            background-color: #e8f5e9;
        }
        
        .pickaxe-item.current {
            border-color: var(--primary-color);
            background-color: #e3f2fd;
            font-weight: bold;
        }
        
        .pickaxe-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--dark-color);
        }
        
        .pickaxe-stats {
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .buy-btn {
            padding: 10px 20px;
            font-size: 14px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            width: 100%;
        }
        
        .buy-btn:hover:not(:disabled) {
            background-color: #e68900;
        }
        
        .buy-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        
        /* ç‚¼è¯ç³»ç»Ÿä¼˜åŒ– */
        .alchemy-system, .forging-system, .embedding-system {
            margin-top: 30px;
            padding: 25px;
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .alchemy-input {
            padding: 12px;
            font-size: 16px;
            width: 200px;
            margin-right: 10px;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }
        
        .alchemy-input:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .alchemy-btn {
            padding: 12px 25px;
            font-size: 16px;
            background-color: #9C27B0;
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .alchemy-btn:hover {
            background-color: #7B1FA2;
        }
        
        .alchemy-result {
            margin-top: 15px;
            padding: 15px;
            background-color: #e3f2fd;
            border-radius: var(--border-radius);
            font-size: 16px;
            font-weight: bold;
            border-left: 4px solid var(--primary-color);
        }
        
        /* èƒ½é‡ç³»ç»Ÿä¼˜åŒ– */
        .energy-system {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(145deg, #e3f2fd, #bbdefb);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        /* ç‰¹æ®Šæ ·å¼ */
        .special-block {
            background: linear-gradient(45deg, #C0C0C0, #E8E8E8, #C0C0C0);
        }
        
        /* é‡ç½®æŒ‰é’®æ ·å¼ */
        .reset-section {
            text-align: center;
            margin: 25px 0;
            padding: 20px;
            background-color: #ffebee;
            border-radius: var(--border-radius);
        }
        
        .reset-btn {
            padding: 12px 24px;
            font-size: 16px;
            background-color: var(--danger-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }
        
        .reset-btn:hover {
            background-color: #d32f2f;
        }
        
        .warning-text {
            color: #666;
            font-size: 14px;
            margin-top: 10px;
        }
        
        /* æ¯ç§’æŒ–çŸ¿æ˜¾ç¤º */
        .mining-per-second-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: var(--border-radius);
            font-weight: bold;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .stats-container {
                grid-template-columns: 1fr;
            }
            
            .pickaxe-list {
                grid-template-columns: 1fr;
            }
            
            .mine-block {
                width: 250px;
                height: 250px;
            }
            
            .system-tabs {
                flex-direction: column;
                align-items: center;
            }
            
            .tab-btn {
                width: 100%;
                max-width: 300px;
            }
            
            .block-controls {
                flex-direction: column;
                align-items: center;
            }
            
            .control-btn {
                width: 100%;
                max-width: 300px;
            }
        }
        
        /* æˆå°±ç³»ç»Ÿæ ·å¼ */
        .achievements-system {
            margin-top: 30px;
            padding: 25px;
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            display: none;
        }
        
        .achievements-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .achievements-search {
            margin: 20px 0;
            text-align: center;
        }
        
        .achievements-summary {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 20px 0;
            color: var(--dark-color);
        }
        
        .achievements-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .achievement-item {
            background-color: white;
            border: 2px solid #ddd;
            border-radius: var(--border-radius);
            padding: 15px;
            transition: var(--transition);
            position: relative;
        }
        
        .achievement-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .achievement-item.completed {
            border-color: var(--secondary-color);
            background-color: #e8f5e9;
        }
        
        .achievement-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--dark-color);
        }
        
        .achievement-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .achievement-progress {
            font-size: 12px;
            color: #888;
        }
        
        .achievement-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .achievement-badge.pending {
            background-color: #ffc107;
        }
        
        .achievement-badge.completed {
            background-color: var(--secondary-color);
            color: white;
        }
        
        /* åŠ¨ç”»æ•ˆæœ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes achievementUnlock {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); box-shadow: 0 0 15px rgba(76, 175, 80, 0.5); }
            100% { transform: scale(1); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease;
        }
        
        .achievement-unlock {
            animation: achievementUnlock 1s ease;
        }
        .block-color-1 { background-color: #8B4513; }
        .block-color-2 { background-color: #A9A9A9; }
        .block-color-3 { background-color: #CD853F; }
        .block-color-4 { background-color: #B87333; }
        .block-color-5 { background-color: #FFD700; }
        .block-color-6 { background-color: #00CED1; }
        .block-color-7 { background-color: #9400D3; }
        .block-color-8 { background-color: #FF4500; }
        .block-color-9 { background-color: #4B0082; }
        .block-color-10 { background-color: #800080; }
        .block-color-11 { background-color: #000000; color: white; }
        .block-color-12 { background-color: #4B0082; color: white; }
        .block-color-13 { background-color: #800080; color: white; }
        .block-color-14 { background-color: #9400D3; color: white; }
        .block-color-15 { background-color: #8A2BE2; color: white; }
        .block-color-16 { background-color: #9370DB; color: white; }
        .block-color-17 { background-color: #DDA0DD; color: black; }
        .block-color-18 { background-color: #EE82EE; color: black; }
        .block-color-19 { background-color: #DA70D6; color: black; }
        .block-color-20 { background-color: #BA55D3; color: white; }
        .block-color-21 { background-color: #9932CC; color: white; }
        .block-color-22 { background-color: #8B008B; color: white; }
        .block-color-23 { background-color: #6A5ACD; color: white; }
        .block-color-24 { background-color: #483D8B; color: white; }
        .block-color-25 { background-color: #3E2723; color: white; }
        .block-color-26 { background-color: #263238; color: white; }
        .block-color-27 { background-color: #1A237E; color: white; }
        .block-color-28 { background-color: #311B92; color: white; }
        .block-color-29 { background-color: #4A148C; color: white; }
        .block-color-30 { background-color: #6A1B9A; color: white; }
        .block-color-31 { background-color: #8E24AA; color: white; }
        .block-color-32 { background-color: #4527A0; color: white; }
        .block-color-33 { background-color: #3949AB; color: white; }
        .block-color-34 { background-color: #303F9F; color: white; }
        .block-color-35 { background-color: #1976D2; color: white; }
        .block-color-36 { background-color: #0D47A1; color: white; }
        .block-color-37 { background-color: #01579B; color: white; }
        .block-color-38 { background-color: #006064; color: white; }
        .block-color-39 { background-color: #004D40; color: white; }
        .block-color-40 { background-color: #1B5E20; color: white; }
        .block-color-41 { background-color: #2E7D32; color: white; }
        .block-color-42 { background-color: #388E3C; color: white; }
        .block-color-43 { background-color: #43A047; color: white; }
        .block-color-44 { background-color: #4CAF50; color: white; }
        .block-color-45 { background-color: #66BB6A; color: black; }
        .block-color-46 { background-color: #81C784; color: black; }
        .block-color-47 { background-color: #A5D6A7; color: black; }
        .block-color-48 { background-color: #C8E6C9; color: black; }
        .block-color-49 { background-color: #E8F5E9; color: black; }
        .block-color-50 { background-color: #F1F8E9; color: black; }
        .block-color-51 { background: linear-gradient(45deg, #FFEB3B, #FFF176); color: black; }
        .block-color-52 { background: linear-gradient(45deg, #FFC107, #FFD54F); color: black; }
        .block-color-53 { background: linear-gradient(45deg, #FF9800, #FFB74D); color: black; }
        .block-color-54 { background: linear-gradient(45deg, #FF5722, #FF8A65); color: black; }
        .alchemy-block-color-1 { background-color: #FF6B6B; }
        .alchemy-block-color-2 { background-color: #4ECDC4; }
        .alchemy-block-color-3 { background-color: #45B7D1; }
        .alchemy-block-color-4 { background-color: #96CEB4; }
        .alchemy-block-color-5 { background-color: #FFEAA7; }
        .special-block-color-1 { background: linear-gradient(45deg, #C0C0C0, #E8E8E8, #C0C0C0); color: #000; }
        .special-block-color-2 { background: linear-gradient(45deg, #FFD700, #FFA500, #FFD700); color: #000; }
            .special-block-color-3 { background: linear-gradient(45deg, #9C27B0, #BA68C8, #9C27B0); color: white; }
            .special-block-color-4 { background: linear-gradient(45deg, #1E88E5, #64B5F6, #1E88E5); color: white; }
            .special-block-color-5 { background: linear-gradient(45deg, #0D47A1, #42A5F5, #0D47A1); color: white; }
            /* å¥‡ç‚¹æ–¹å—æ ·å¼ */
            .special-block-color-7,
            .special-block-color-8,
            .special-block-color-9,
            .special-block-color-10,
            .special-block-color-11 { background: linear-gradient(45deg, #4B0082, #8A2BE2, #4B0082); color: white; border-color: #9370DB; }
            .special-block-color-8 { background: linear-gradient(45deg, #800080, #9370DB, #800080); }
            .special-block-color-9 { background: linear-gradient(45deg, #9400D3, #BA55D3, #9400D3); }
            .special-block-color-10 { background: linear-gradient(45deg, #8B008B, #DA70D6, #8B008B); }
            .special-block-color-11 { background: linear-gradient(45deg, #9932CC, #DDA0DD, #9932CC); color: white; }

/* ç»ˆç„‰æ ¸å¿ƒæ–¹å— - é»‘è‰²æ¸å˜ */
.special-block-black-gradient {
    background: linear-gradient(45deg, #000000, #1a1a1a, #000000, #1a1a1a, #000000);
    color: white;
    border-color: #333333;
    animation: blackPulse 3s infinite;
    background-size: 200% 200%;
}

/* ç»ˆç„‰é›†é˜µæ–¹å— - å½©è‰²æ¸å˜ */
.special-block-colorful-gradient {
    background: linear-gradient(135deg, #FF0000, #FF5500, #FF7F00, #FFAA00, #FFFF00, #AAFF00, #00FF00, #00AAFF, #0000FF, #4B0082, #8B00FF, #CC00FF, #FF00AA, #FF0000);
    color: white;
    border-color: #FFFFFF;
    animation: colorShift 2.78s ease infinite;
    background-size: 600% 600%;
}

@keyframes blackPulse {
    0%, 100% { background-position: 0% 50%; box-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }
    50% { background-position: 100% 50%; box-shadow: 0 0 20px rgba(255, 255, 255, 0.5); }
}

@keyframes colorShift {
    0% { background-position: 0% 50%; box-shadow: 0 0 15px rgba(255, 0, 0, 0.5); }
    12.5% { background-position: 20% 50%; box-shadow: 0 0 15px rgba(255, 77, 0, 0.5); }
    25% { background-position: 40% 50%; box-shadow: 0 0 15px rgba(255, 155, 0, 0.5); }
    37.5% { background-position: 80% 50%; box-shadow: 0 0 15px rgba(255, 255, 0, 0.5); }
    50% { background-position: 120% 50%; box-shadow: 0 0 15px rgba(127, 255, 0, 0.5); }
    62.5% { background-position: 180% 50%; box-shadow: 0 0 15px rgba(0, 179, 255, 0.5); }
    75% { background-position: 240% 50%; box-shadow: 0 0 15px rgba(0, 0, 255, 0.5); }
    87.5% { background-position: 300% 50%; box-shadow: 0 0 15px rgba(139, 0, 255, 0.5); }
    100% { background-position: 360% 50%; box-shadow: 0 0 15px rgba(255, 0, 127, 0.5); }
}          /* é•¶åµŒç³»ç»Ÿæ ·å¼ */
            .embedding-block {
                margin: 20px 0;
                padding: 15px;
                background-color: #e3f2fd;
                border-radius: 5px;
                border: 1px solid #bbdefb;
            }
            .embedding-blocks {
                margin-top: 20px;
            }
            .embedding-block h4 {
                margin-top: 0;
                color: #1565C0;
            }
            .embedding-block p {
                margin: 5px 0;
                font-size: 16px;
            }
            .alchemy-block-color-6 { background-color: #FF6B6B; }
            .alchemy-block-color-7 { background-color: #4ECDC4; }
            .alchemy-block-color-8 { background-color: #45B7D1; }
            .alchemy-block-color-9 { background-color: #96CEB4; }
            .alchemy-block-color-10 { background-color: #FFEAA7; }
            .alchemy-block-color-11 { background-color: #DDA0DD; }
            .alchemy-block-color-12 { background-color: #9370DB; }
            .alchemy-block-color-13 { background-color: #8A2BE2; }
            .alchemy-block-color-14 { background-color: #9400D3; }
            .alchemy-block-color-15 { background-color: #800080; }
            .alchemy-block-color-16 { background-color: #4B0082; color: white; }
    </style>
    
</head>
<body>
    <div class="game-container">
        <h1>æŒ–çŸ¿æ¸¸æˆ</h1>
        
        <!-- FPSæ˜¾ç¤ºå…ƒç´  -->
        <div id="fps-counter" style="position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 5px 10px; border-radius: 5px; font-family: monospace; font-size: 14px; z-index: 1000;">FPS: 0</div>
        
        <!-- æ¯ç§’æŒ–çŸ¿æ˜¾ç¤ºå°†é€šè¿‡JavaScriptåŠ¨æ€åˆ›å»º -->
        
        <div class="stats-container">
            <!-- åŸºç¡€ä¿¡æ¯ -->
            <div class="stats-group fade-in">
                <h3>åŸºç¡€ä¿¡æ¯</h3>
                <div class="stat-item">
                    <span class="stat-label">é‡‘å¸:</span>
                    <span class="stat-value" id="gold">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">å½“å‰é•å­:</span>
                    <span class="stat-value" id="current-pickaxe">æœ¨é•</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">æ”»å‡»ä¼¤å®³:</span>
                    <span class="stat-value" id="attack-damage">1</span>
                </div>
                <div class="stat-item" id="auto-save-status">
                    <span class="stat-value">è‡ªåŠ¨ä¿å­˜: è¿›è¡Œä¸­</span>
                </div>
            </div>
            
            <!-- å¢ç›Šä¿¡æ¯ -->
            <div class="stats-group fade-in">
                <h3>å¢ç›Šå±æ€§</h3>
                <div class="stat-item">
                    <span class="stat-label">é•å­å¢ç›Š:</span>
                    <span class="stat-value" id="pickaxe-bonus">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ä½¿ç”¨å¢ç›Š:</span>
                    <span class="stat-value" id="usage-bonus">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">é‡‘å¸å¢ç›Š:</span>
                    <span class="stat-value" id="gold-bonus">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç‚¼è¯å¢ç›Š:</span>
                    <span class="stat-value" id="alchemy-bonus">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç»ˆç„‰å¢ç›Š:</span>
                    <span class="stat-value" id="end-bonus">1å€</span>
                </div>
            </div>
            
            <!-- èµ„æºä¿¡æ¯ -->
            <div class="stats-group resources fade-in">
                <h3>ç¨€æœ‰èµ„æº</h3>
                <div class="stat-item">
                    <span class="stat-label">ç‚¼è¯å€¼:</span>
                    <span class="stat-value" id="alchemy-points">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç‚¼è¯ç»“æ™¶:</span>
                    <span class="stat-value" id="alchemy-crystals">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">é“±é”­:</span>
                    <span class="stat-value" id="iridium-ingots">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ğ¬­¶é”­:</span>
                    <span class="stat-value" id="hassium-ingots">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">å¥‡ç‚¹:</span>
                    <span class="stat-value" id="singularity">0</span>
                </div>
            </div>
            
            <!-- é«˜çº§èµ„æº -->
            <div class="stats-group advanced fade-in">
                <h3>é«˜çº§èµ„æº</h3>
                <div class="stat-item">
                    <span class="stat-label">ç‰©è´¨:</span>
                    <span class="stat-value" id="matter">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">èƒ½é‡:</span>
                    <span class="stat-value" id="energy">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">é‡äº§æ ¸å¿ƒ:</span>
                    <span class="stat-value" id="production-core">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">ç»ˆç„‰æ ¸å¿ƒ:</span>
                    <span class="stat-value" id="end-core">0</span>
                </div>
            </div>
            
            <!-- èƒ½é‡ç³»ç»Ÿ -->
            <div class="stats-group fade-in">
                <h3>èƒ½é‡ç³»ç»Ÿ</h3>
                <div class="stat-item">
                    <span class="stat-label">èƒ½é‡å€é€Ÿ:</span>
                    <span class="stat-value" id="energy-multiplier">1</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">èƒ½é‡å¢ç›Š:</span>
                    <span class="stat-value" id="energy-bonus">1</span>
                </div>
            </div>
        </div>
        
        <div class="system-tabs fade-in">
            <button class="tab-btn active" id="mining-tab">æŒ–çŸ¿ç³»ç»Ÿ</button>
            <button class="tab-btn" id="alchemy-tab">ç‚¼è¯ç³»ç»Ÿ</button>
            <button class="tab-btn" id="forging-tab">æ·¬ç‚¼ç³»ç»Ÿ</button>
            <button class="tab-btn" id="embedding-tab">é•¶åµŒç³»ç»Ÿ</button>
            <button class="tab-btn" id="achievements-tab">æˆå°±ç³»ç»Ÿ</button>
        </div>
        
        <div style="text-align: center; margin-bottom: 20px;">
            <button class="control-btn" id="reset-game-btn" style="background-color: #f44336;">é‡ç½®æ¸¸æˆ</button>
            <p style="color: #666; font-size: 12px; margin-top: 5px;">é‡ç½®å°†æ¸…é™¤æ‰€æœ‰æ¸¸æˆæ•°æ®ï¼Œæ— æ³•æ¢å¤ï¼</p>
        </div>
        
        <!-- æˆå°±ç³»ç»Ÿ -->
        <div id="achievements-system" class="achievements-system fade-in">
            <h2 class="shop-title">æˆå°±ç³»ç»Ÿ</h2>
            <div class="achievements-controls">
                <button class="control-btn" id="achievement-category-all">æ‰€æœ‰æˆå°±</button>
                <button class="control-btn" id="achievement-category-resources">èµ„æºæˆå°±</button>
                <button class="control-btn" id="achievement-category-stats">å±æ€§æˆå°±</button>
                <button class="control-btn" id="achievement-category-mining">æŒ–çŸ¿æˆå°±</button>
                <button class="control-btn" id="achievement-category-completed">å·²å®Œæˆ</button>
            </div>
            <div class="achievements-search">
                <input type="text" id="achievement-search" placeholder="æœç´¢æˆå°±..." class="alchemy-input">
            </div>
            <div class="achievements-summary">
                <p>å·²å®Œæˆ: <span id="completed-achievements-count">0</span>/<span id="total-achievements-count">0</span></p>
            </div>
            <div class="achievements-list" id="achievements-list">
                <!-- æˆå°±å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="alchemy-system fade-in">
            <div class="shop-title">ç‚¼è¯ç³»ç»Ÿ</div>
            <div style="margin-top: 15px;">
                <h3>ä¸€é”®ç‚¼è¯</h3>
                <input type="number" class="alchemy-input" id="batch-alchemy-value" placeholder="æ¯æ¬¡ç‚¼è¯å€¼" min="1">
                <input type="number" class="alchemy-input" id="batch-alchemy-times" placeholder="ç‚¼è¯æ¬¡æ•°" min="1" max="1000">
                <button class="alchemy-btn" id="batch-alchemy-btn">ä¸€é”®ç‚¼è¯</button>
            </div>
            <div style="margin-top: 20px;">
                <h3>ç‚¼è¯ç»“æ™¶</h3>
                <p>ç‚¼è¯å€¼10000ä»¥ä¸Šå¯ä»¥ç»“æ™¶ï¼Œè·å¾— <span id="crystals-preview">0.0</span> ç»“æ™¶</p>
                <button class="alchemy-btn" id="crystallize-btn" disabled>ç»“æ™¶</button>
            </div>
            <div class="alchemy-result" id="alchemy-result"></div>
        </div>
        
        <div class="forging-system fade-in">
            <div class="shop-title">æ·¬ç‚¼ç³»ç»Ÿ</div>
            <div style="margin-top: 15px;">
                <h3>æ¶ˆè€—ç‚¼è¯ç»“æ™¶è¿›è¡Œæ·¬ç‚¼</h3>
                <input type="number" class="alchemy-input" id="forging-crystal-value" placeholder="æ¶ˆè€—ç»“æ™¶æ•°é‡" min="1">
                <button class="alchemy-btn" id="forging-btn">å¼€å§‹æ·¬ç‚¼</button>
            </div>
            <div style="margin-top: 20px;">
                <h3>å½“å‰æ·¬ç‚¼å±æ€§</h3>
                <div class="forging-stats">
                    <div class="forging-stat-item">ä¼¤å®³å¢ç›Š: <span id="forging-damage-bonus">0%</span></div>
                    <div class="forging-stat-item">æ¯æ¬¡æ”»å‡»è·å¾—ä½¿ç”¨å¢ç›Š: <span id="forging-usage-bonus">0%</span></div>
                    <div class="forging-stat-item">æ¯æ¬¡è·å¾—é‡‘å¸: <span id="forging-gold-gain">0%</span></div>
                    <div class="forging-stat-item">ç»“æ™¶æ–¹å—è·å¾—ç‚¼è¯å¢ç›Š: <span id="forging-crystal-bonus">0%</span></div>
                </div>
            </div>
            <div class="alchemy-result" id="forging-result"></div>
        </div>
        
        <!-- é•¶åµŒç³»ç»Ÿ -->
        <div class="embedding-system fade-in">
            <div class="shop-title">é•¶åµŒç³»ç»Ÿ</div>
            <div style="margin-top: 15px;">
                <h3>å½“å‰å¥‡ç‚¹æ•°é‡: <span id="embedding-singularity-count">0</span></h3>
                
                <!-- é•¶åµŒåŒºå— -->
                <div class="embedding-blocks">
                    <div class="embedding-block">
                        <h4>é•¶åµŒåŒºå—1 - æ”»å‡»å¢ç›Š</h4>
                        <p>å½“å‰é•¶åµŒ: <span id="embedding-count-0">0</span> å¥‡ç‚¹</p>
                        <p>å¢ç›Šå€ç‡: <span id="embedding-bonus-0">1.00</span>x (æ”»å‡»Ã—((é•¶åµŒæ•°é‡+1)^0.36))</p>
                        <input type="number" class="alchemy-input" id="embedding-input-0" placeholder="é•¶åµŒæ•°é‡" min="1">
                        <button class="alchemy-btn" onclick="embedSingularity(0)">é•¶åµŒå¥‡ç‚¹</button>
                    </div>
                    
                    <div class="embedding-block">
                        <h4>é•¶åµŒåŒºå—2 - ç‚¼è¯å€¼è·å–å¢ç›Š</h4>
                        <p>å½“å‰é•¶åµŒ: <span id="embedding-count-1">0</span> å¥‡ç‚¹</p>
                        <p>å¢ç›Šå€ç‡: <span id="embedding-bonus-1">1.00</span>x (ç‚¼è¯å€¼è·å–Ã—((é•¶åµŒæ•°é‡+1)^0.28))</p>
                        <input type="number" class="alchemy-input" id="embedding-input-1" placeholder="é•¶åµŒæ•°é‡" min="1">
                        <button class="alchemy-btn" onclick="embedSingularity(1)">é•¶åµŒå¥‡ç‚¹</button>
                    </div>
                    
                    <div class="embedding-block">
                        <h4>é•¶åµŒåŒºå—3 - ä½¿ç”¨å¢ç›Šè·å–å¢ç›Š</h4>
                        <p>å½“å‰é•¶åµŒ: <span id="embedding-count-2">0</span> å¥‡ç‚¹</p>
                        <p>å¢ç›Šå€ç‡: <span id="embedding-bonus-2">1.00</span>x (ä½¿ç”¨å¢ç›Šè·å–Ã—((é•¶åµŒæ•°é‡+1)^0.24))</p>
                        <input type="number" class="alchemy-input" id="embedding-input-2" placeholder="é•¶åµŒæ•°é‡" min="1">
                        <button class="alchemy-btn" onclick="embedSingularity(2)">é•¶åµŒå¥‡ç‚¹</button>
                    </div>
                    
                    <div class="embedding-block">
                        <h4>é•¶åµŒåŒºå—4 - é‡‘å¸è·å–å¢ç›Š</h4>
                        <p>å½“å‰é•¶åµŒ: <span id="embedding-count-3">0</span> å¥‡ç‚¹</p>
                        <p>å¢ç›Šå€ç‡: <span id="embedding-bonus-3">1.00</span>x (é‡‘å¸è·å–Ã—((é•¶åµŒæ•°é‡+1)^0.2))</p>
                        <input type="number" class="alchemy-input" id="embedding-input-3" placeholder="é•¶åµŒæ•°é‡" min="1">
                        <button class="alchemy-btn" onclick="embedSingularity(3)">é•¶åµŒå¥‡ç‚¹</button>
                    </div>
                    
                    <div class="embedding-block">
                        <h4>é•¶åµŒåŒºå—5 - å…¨å±æ€§å¢ç›Š</h4>
                        <p>å½“å‰é•¶åµŒ: <span id="embedding-count-4">0</span> å¥‡ç‚¹</p>
                        <p>å¢ç›Šå€ç‡: <span id="embedding-bonus-4">1.00</span>x (æ”»å‡»ã€ç‚¼è¯å€¼è·å–ã€é‡‘å¸è·å–ã€ä½¿ç”¨å¢ç›Šè·å–Ã—((é•¶åµŒæ•°é‡+1)^0.16))</p>
                        <input type="number" class="alchemy-input" id="embedding-input-4" placeholder="é•¶åµŒæ•°é‡" min="1">
                        <button class="alchemy-btn" onclick="embedSingularity(4)">é•¶åµŒå¥‡ç‚¹</button>
                    </div>
                </div>
                
                <!-- é‡ç½®æŒ‰é’® -->
                <div style="margin-top: 20px;">
                    <button class="alchemy-btn" onclick="resetEmbedding()" style="background-color: #f44336;">é‡ç½®é•¶åµŒ</button>
                    <p style="color: #666; margin-top: 10px;">é‡ç½®é•¶åµŒå°†å–å›æ‰€æœ‰é•¶åµŒçš„å¥‡ç‚¹</p>
                </div>
            </div>
            <div class="alchemy-result" id="embedding-result"></div>
        </div>
        
        <div class="mining-area fade-in">
            <div class="block-controls">
                <button class="control-btn" id="prev-block">ä¸Šä¸€çº§æ–¹å—</button>
                <button class="control-btn" id="next-block">ä¸‹ä¸€çº§æ–¹å—</button>
                <button class="control-btn" id="toggle-block-type">åˆ‡æ¢æ–¹å—ç±»å‹: æ™®é€š</button>
            </div>
            
            <div class="mine-block" id="mine-block">
                <div class="block-level">1çº§æ–¹å—</div>
                <div class="health-bar">
                    <div class="health-fill" id="health-fill"></div>
                </div>
                <div class="block-health">è¡€é‡: <span id="block-health">1000</span>/<span id="block-max-health">1000</span></div>
                <div class="block-reward"><span id="block-reward">å¥–åŠ±: 1 é‡‘å¸</span></div>
            </div>

        
        <div class="pickaxe-shop fade-in">
            <div class="shop-title">é•å­å•†åº—</div>
            <div class="pickaxe-list" id="pickaxe-list">
                <!-- é•å­ä¼šé€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <div class="energy-system fade-in">
            <h3>èƒ½é‡è½¬åŒ–ç³»ç»Ÿ</h3>
            <p>æ¶ˆè€—100ä¸‡ç‰©è´¨æå‡èƒ½é‡å€é€Ÿ</p>
            <button class="alchemy-btn" id="convert-energy-btn">æå‡å€é€Ÿ</button>
            <button class="alchemy-btn" id="convert-energy-max-btn">ä¸€é”®æå‡å€é€Ÿ</button>
            <div class="energy-stats">
                <p>èƒ½é‡å€é€Ÿ: <span id="energy-multiplier-display">1</span></p>
                <p>æ¯0.1ç§’å¢åŠ é‡: <span id="energy-gain-rate">0</span></p>
            </div>
        </div>
        
        <div class="pickaxe-shop fade-in">
            <div class="shop-title">é•å­å•†åº—</div>
            <div class="pickaxe-list" id="pickaxe-list">
                <!-- é•å­ä¼šé€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- ç‰¹æ®Šæ–¹å—é€šè¿‡ä¸»æŒ–çŸ¿åŒºåŸŸæ˜¾ç¤º -->
    </div>

    <script>
        // æ¸¸æˆæ•°æ®
        const gameData = {
            gold: 0,
            currentPickaxeIndex: 0,
            currentBlockIndex: 0,
            currentAlchemyBlockIndex: 0,
            currentSpecialBlockIndex: 0,
            usageBonus: 1,
            alchemyBonus: 1,
            alchemyPoints: 0,
            alchemyCrystals: 0, // ç‚¼è¯ç»“æ™¶
            iridiumIngots: 0,
            hassiumIngots: 0, // ğ¬­¶é”­
            singularity: 0, // å¥‡ç‚¹æ•°é‡
            matter: 0, // ç‰©è´¨
            energy: 0, // èƒ½é‡
            energyMultiplier: 0, // èƒ½é‡å€é€Ÿ
            productionCore: 0, // é‡äº§æ ¸å¿ƒ
            endCore: 0, // ç»ˆç„‰æ ¸å¿ƒ
            ownedPickaxes: [0], // 0è¡¨ç¤ºæœ¨é•å·²æ‹¥æœ‰
            currentBlockType: 'normal', // 'normal', 'alchemy', 'special' æˆ– 'singularity'
            autoMiningEnabled: false, // è‡ªåŠ¨æŒ–çŸ¿çŠ¶æ€
            miningCount: 0, // æŒ–çŸ¿æ¬¡æ•°è®¡æ•°
            miningPerSecond: 0, // æ¯ç§’æŒ–çŸ¿æ¬¡æ•°
            // æ·¬ç‚¼å±æ€§
            forgingStats: {
                damageBonus: 0, // ä¼¤å®³å¢ç›Šç™¾åˆ†æ¯”
                usageBonusGain: 0, // æ¯æ¬¡æ”»å‡»è·å¾—ä½¿ç”¨å¢ç›Šç™¾åˆ†æ¯”
                goldGain: 0, // æ¯æ¬¡è·å¾—é‡‘å¸ç™¾åˆ†æ¯”
                crystalBonusGain: 0 // ç»“æ™¶æ–¹å—è·å¾—ç‚¼è¯å¢ç›Šç™¾åˆ†æ¯”
            },
            // å¥‡ç‚¹æ–¹å—ç´¢å¼•
            currentSingularityBlockIndex: 0,
            // é•¶åµŒç³»ç»Ÿæ•°æ®
            embeddingBlocks: [
                { count: 0, exponent: 0.36, name: 'æ”»å‡»å¢ç›Š' }, // é•¶åµŒåŒºå—1ï¼šæ”»å‡»Ã—((é•¶åµŒæ•°é‡+1)^0.36)
                { count: 0, exponent: 0.28, name: 'ç‚¼è¯å€¼è·å–å¢ç›Š' }, // é•¶åµŒåŒºå—2ï¼šç‚¼è¯å€¼è·å–Ã—((é•¶åµŒæ•°é‡+1)^0.28)
                { count: 0, exponent: 0.24, name: 'ä½¿ç”¨å¢ç›Šè·å–å¢ç›Š' }, // é•¶åµŒåŒºå—3ï¼šä½¿ç”¨å¢ç›Šè·å–Ã—((é•¶åµŒæ•°é‡+1)^0.24)
                { count: 0, exponent: 0.2, name: 'é‡‘å¸è·å–å¢ç›Š' }, // é•¶åµŒåŒºå—4ï¼šé‡‘å¸è·å–Ã—((é•¶åµŒæ•°é‡+1)^0.2)
                { count: 0, exponent: 0.16, name: 'å…¨å±æ€§å¢ç›Š' } // é•¶åµŒåŒºå—5ï¼šæ”»å‡»ã€ç‚¼è¯å€¼è·å–ã€é‡‘å¸è·å–ã€ä½¿ç”¨å¢ç›Šè·å–Ã—((é•¶åµŒæ•°é‡+1)^0.16)
            ],
            // æˆå°±ç³»ç»Ÿæ•°æ®
            achievements: [],
            completedAchievements: {}
        };

        // é•å­æ•°æ®
        const pickaxes = [
            { name: 'æœ¨é•', bonus: 1, usageBonus: 1, cost: 0, costType: 'gold' },
            { name: 'çŸ³é•', bonus: 2, usageBonus: 2, cost: 1000, costType: 'gold' },
            { name: 'é“é•', bonus: 5, usageBonus: 3, cost: 100000, costType: 'gold' },
            { name: 'é‡‘é•', bonus: 10, usageBonus: 5, cost: 1000000, costType: 'gold' },
            { name: 'é’»çŸ³é•', bonus: 30, usageBonus: 10, cost: 20000000, costType: 'gold' },
            { name: 'ä¸‹ç•Œåˆé‡‘é•', bonus: 50, usageBonus: 15, cost: 100000000, costType: 'gold' },
            { name: 'é™„é­”ä¸‹ç•Œåˆé‡‘é•', bonus: 100, usageBonus: 25, cost: 1000000000, costType: 'gold' },
            { name: 'é“±é•', bonus: 1000, usageBonus: 100, cost: 20, costType: 'iridium' },
            { name: 'é«˜çº¯åº¦é“±é•', bonus: 4000, usageBonus: 200, cost: 1000, costType: 'iridium' },
            { name: 'ğ¬­¶é•', bonus: 30000, usageBonus: 600, cost: 20, costType: 'hassium' }, // 20ğ¬­¶é”­ï¼Œå¢ç›Š30000ï¼Œä½¿ç”¨å¢ç›Š600
            { name: 'é«˜çº¯åº¦ğ¬­¶é•', bonus: 100000, usageBonus: 1000, cost: 1000, costType: 'hassium' }, // 1000ğ¬­¶é”­ï¼Œå¢ç›Š100000ï¼Œä½¿ç”¨å¢ç›Š1000
            { name: 'é‡‘å¸ç¥é•', bonus: 240000, usageBonus: 1600, cost: 1000000000000000000000, costType: 'gold' }, // 10å“é‡‘å¸(10^22)ï¼Œå¢ç›Š240000ï¼Œä½¿ç”¨å¢ç›Š1600
            { name: 'åˆé˜¶å¥‡ç‚¹é•', bonus: 540000, usageBonus: 2600, cost: 100, costType: 'singularity' }, // 100å¥‡ç‚¹ï¼Œå¢ç›Š54ä¸‡ï¼Œæ¯æ¬¡ä½¿ç”¨2600
            { name: 'ä¸­é˜¶å¥‡ç‚¹é•', bonus: 1200000, usageBonus: 4400, cost: 1000, costType: 'singularity' }, // 1000å¥‡ç‚¹ï¼Œå¢ç›Š120ä¸‡ï¼Œæ¯æ¬¡ä½¿ç”¨4400
            { name: 'é«˜é˜¶å¥‡ç‚¹é•', bonus: 4000000, usageBonus: 7600, cost: 10000, costType: 'singularity' }, // 1ä¸‡å¥‡ç‚¹ï¼Œå¢ç›Š400ä¸‡ï¼Œæ¯æ¬¡ä½¿ç”¨7600
            { name: 'é¡¶é˜¶å¥‡ç‚¹é•', bonus: 10000000, usageBonus: 16000, cost: 100000, costType: 'singularity' }, // 10ä¸‡å¥‡ç‚¹ï¼Œå¢ç›Š1000ä¸‡ï¼Œæ¯æ¬¡ä½¿ç”¨16000
            { name: 'èƒ½é‡é•', bonus: 20000000, usageBonus: 24000, cost: 100000, costType: 'energy' }, // 10ä¸‡èƒ½é‡ï¼Œå¢ç›Š2000ä¸‡ï¼Œä½¿ç”¨24000
            { name: 'èšèƒ½é•', bonus: 100000000, usageBonus: 36000, cost: 10000000, costType: 'energy' }, // 1000ä¸‡èƒ½é‡ï¼Œå¢ç›Š1äº¿ï¼Œä½¿ç”¨36000
            { name: 'æèƒ½é•', bonus: 320000000, usageBonus: 54000, cost: 100000000, costType: 'energy' }, // 1äº¿èƒ½é‡ï¼Œå¢ç›Š3.2äº¿ï¼Œä½¿ç”¨54000
            { name: 'é‡èƒ½é•', bonus: 1600000000, usageBonus: 188000, costs: [{type: 'productionCore', amount: 5000}, {type: 'energy', amount: 500000000}] }, // 5000é‡äº§æ ¸å¿ƒ+5äº¿èƒ½é‡ï¼Œå¢ç›Š16äº¿ï¼Œä½¿ç”¨188000
            { name: 'ä½¿ç”¨é•', bonus: 1, usageBonus: 1000000000000000, specialType: 'usage', costType: 'usage_bonus', cost: 1000000000000000000000, description: 'ä¼¤å®³å¼ºåˆ¶ä¸º1ï¼Œä½†è·å¾—æå¼ºçš„ä½¿ç”¨å¢ç›Š' }, // 1äº¬ä½¿ç”¨å¢ç›Šï¼Œç‰¹æ®Šé•å­
            { name: 'é»‘æ´é•', bonus: 1, usageBonus: 1, specialType: 'black_hole', cost: 100000, costType: 'singularity', description: 'æ‰€æœ‰æ¦‚ç‡ç‰©å“å¿…å‡ºï¼Œç‰¹æ®Šæ‰è½ä¼˜åŒ–' }, // 10ä¸‡å¥‡ç‚¹ï¼Œç‰¹æ®Šé•å­
            { name: 'ç»ˆç„‰é•', bonus: 128000000000, usageBonus: 4000000, cost: 1000, costType: 'endCore', description: 'æå¼ºçš„é•å­ï¼Œç”±ç»ˆç„‰æ ¸å¿ƒæ‰“é€ ï¼Œæ‹¥æœ‰æé«˜çš„åŸºç¡€ä¼¤å®³å’Œä½¿ç”¨å¢ç›Š' }, // 1000ç»ˆç„‰æ ¸å¿ƒï¼Œå¢ç›Š1280äº¿ï¼Œä½¿ç”¨4000000
            { name: 'æ°¸æ’é•', bonus: 1024000000000000, usageBonus: 1024000000, costs: [{type: 'endCore', amount: 100000}, {type: 'iridiumIngots', amount: 100000}, {type: 'hassiumIngots', amount: 100000}, {type: 'singularity', amount: 10000000}, {type: 'gold', amount: 10000000000000000000000}, {type: 'alchemyCrystals', amount: 100000000}, {type: 'energy', amount: 100000000000}, {type: 'matter', amount: 1000000000}, {type: 'usage_bonus', amount: 10000000000}], description: 'ç»ˆæé•å­ï¼ŒæŒ–ç»“æ™¶æ–¹å—æ—¶ç‚¼è¯å¢ç›ŠÃ—10000ã€ç‰©è´¨Ã—100000000ã€é‡äº§æ ¸å¿ƒÃ—1000000ã€é‡‘å¸Ã—1000000ï¼Œå¥‡ç‚¹è·å–Ã—100000' } // 10Wç»ˆç„‰æ ¸å¿ƒ+10Wé“±é”­+10Wğ¬­¶é”­+1å…†å¥‡ç‚¹+1000è½½é‡‘å¸+10äº¿ç‚¼è¯ç»“æ™¶+1000äº¿èƒ½é‡+10äº¿ç‰©è´¨+10æ¼ä½¿ç”¨å¢ç›Š
        ];

        // æ™®é€šæ–¹å—æ•°æ®
        const blocks = [
            { level: 1, health: 1000, reward: 1 },
            { level: 2, health: 10000, reward: 5 },
            { level: 3, health: 50000, reward: 10 },
            { level: 4, health: 1000000, reward: 150 },
            { level: 5, health: 6000000, reward: 500 },
            { level: 6, health: 24000000, reward: 1800 },
            { level: 7, health: 100000000, reward: 6000 },
            { level: 8, health: 1000000000, reward: 40000 },
            { level: 9, health: 30000000000, reward: 1000000 },
            { level: 10, health: 1000000000000, reward: 20000000 },
            { level: 11, health: 200000000000000, reward: 1000000000 }, // 200å…†è¡€é‡ï¼Œ10äº¿é‡‘å¸
            { level: 12, health: 1000000000000000, reward: 3000000000 }, // 1000å…†è¡€é‡ï¼Œ30äº¿é‡‘å¸
            { level: 13, health: 100000000000000000, reward: 10000000000 }, // 10äº¬è¡€é‡ï¼Œ100äº¿é‡‘å¸
            { level: 14, health: 10000000000000000000, reward: 40000000000 }, // 1000äº¬è¡€é‡ï¼Œ400äº¿é‡‘å¸
            { level: 15, health: 10000000000000000000000, reward: 1000000000000 }, // 100å“è¡€é‡ï¼Œ1å…†é‡‘å¸
            { level: 16, health: 1200000000000000000000000, reward: 3600000000000 }, // 1.2æ¼è¡€é‡ï¼Œ3.6å…†é‡‘å¸
            { level: 17, health: 240000000000000000000000000, reward: 60000000000000 }, // 240æ¼è¡€é‡ï¼Œ60å…†é‡‘å¸
            { level: 18, health: 1000000000000000000000000000000, reward: 1000000000000000 }, // 10ç©°è¡€é‡ï¼Œ1000å…†é‡‘å¸
            { level: 19, health: 1000000000000000000000000000000000, reward: 480000000000000 }, // 10æ²Ÿè¡€é‡ï¼Œ4.8äº¬é‡‘å¸
            { level: 20, health: 1000000000000000000000000000000000000, reward: 12000000000000000 }, // 1æ¶§è¡€é‡ï¼Œ120äº¬é‡‘å¸
            { level: 21, health: 10000000000000000000000000000000000000000, reward: 6000000000000000000 }, // 1æ­£è¡€é‡ï¼Œ6000äº¬é‡‘å¸
            { level: 22, health: 100000000000000000000000000000000000000000000, reward: 100000000000000000000 }, // 1è½½è¡€é‡ï¼Œ10å“é‡‘å¸
            { level: 23, health: 1000000000000000000000000000000000000000000000000, reward: 36000000000000000000000 }, // 1æè¡€é‡ï¼Œ360å“é‡‘å¸
            { level: 24, health: 10000000000000000000000000000000000000000000000000000, reward: 1000000000000000000000000 }, // 1æ’æ²³æ²™è¡€é‡ï¼Œ1æ¼é‡‘å¸
            { level: 25, health: 100000000000000000000000000000000000000000000000000000000, reward: 10000000000000000000000000 }, // 1é˜¿æ›¾ç¥‡è¡€é‡ï¼Œ10æ¼é‡‘å¸
            { level: 26, health: 1000000000000000000000000000000000000000000000000000000000000, reward: 100000000000000000000000000 }, // 1é‚£ç”±ä»–è¡€é‡ï¼Œ100æ¼é‡‘å¸
            { level: 27, health: 10000000000000000000000000000000000000000000000000000000000000000, reward: 1000000000000000000000000000 }, // 1ä¸å¯æ€è®®è¡€é‡ï¼Œ1000æ¼é‡‘å¸
            { level: 28, health: 100000000000000000000000000000000000000000000000000000000000000000000, reward: 10000000000000000000000000000 }, // 1æ— é‡è¡€é‡ï¼Œ10000æ¼é‡‘å¸
            { level: 29, health: 1000000000000000000000000000000000000000000000000000000000000000000000000, reward: 100000000000000000000000000000 }, // 1å¤§æ•°è¡€é‡ï¼Œ100000æ¼é‡‘å¸
            { level: 30, health: 1e76, reward: 1000000000000000000000000000000 }, // 1å…¨ä»•ç¥¥è¡€é‡ï¼Œ1000000æ¼é‡‘å¸
            { level: 31, health: 1e80, reward: 10000000000000000000000000000000 }, // 1ä¸‡å…¨ä»•ç¥¥è¡€é‡ï¼Œ10000000æ¼é‡‘å¸
            { level: 32, health: 1e84, reward: 100000000000000000000000000000000 }, // 1å¤æˆˆå°”è¡€é‡ï¼Œ100000000æ¼é‡‘å¸
            { level: 33, health: 1e88, reward: 1000000000000000000000000000000000 }, // 1å¤æˆˆå°”æ™®å‹’å…‹æ–¯è¡€é‡ï¼Œ1000000000æ¼é‡‘å¸
            { level: 34, health: 1e92, reward: 10000000000000000000000000000000000 }, // 1å¤æˆˆå°”ç±³æ™®å‹’å…‹æ–¯è¡€é‡ï¼Œ10000000000æ¼é‡‘å¸
            { level: 35, health: 1e96, reward: 100000000000000000000000000000000000 }, // 1è‘›ç«‹æ’æ•°è¡€é‡ï¼Œ100000000000æ¼é‡‘å¸
            { level: 36, health: 1e100, reward: 1000000000000000000000000000000000000 }, // 1å¡”ç€æ•°è¡€é‡ï¼Œ1000000000000æ¼é‡‘å¸
            { level: 37, health: 1e104, reward: 10000000000000000000000000000000000000 }, // 1ä¸å¯åçŠ¶æ•°è¡€é‡ï¼Œ10000000000000æ¼é‡‘å¸
            { level: 38, health: 1e108, reward: 100000000000000000000000000000000000000 }, // 1ä¸‡å¤æˆˆå°”è¡€é‡ï¼Œ100000000000000æ¼é‡‘å¸
            { level: 39, health: 1e112, reward: 1000000000000000000000000000000000000000 }, // 1äº¿å¤æˆˆå°”è¡€é‡ï¼Œ1000000000000000æ¼é‡‘å¸
            { level: 40, health: 1e116, reward: 10000000000000000000000000000000000000000 }, // 1å…†å¤æˆˆå°”è¡€é‡ï¼Œ10000000000000000æ¼é‡‘å¸
            { level: 41, health: 1e120, reward: 100000000000000000000000000000000000000000 }, // 41çº§æ–¹å—
            { level: 42, health: 1e124, reward: 1000000000000000000000000000000000000000000 }, // 42çº§æ–¹å—
            { level: 43, health: 1e128, reward: 10000000000000000000000000000000000000000000 }, // 43çº§æ–¹å—
            { level: 44, health: 1e132, reward: 100000000000000000000000000000000000000000000 }, // 44çº§æ–¹å—
            { level: 45, health: 1e136, reward: 1000000000000000000000000000000000000000000000 }, // 45çº§æ–¹å—
            { level: 46, health: 1e140, reward: 10000000000000000000000000000000000000000000000 }, // 46çº§æ–¹å—
            { level: 47, health: 1e144, reward: 100000000000000000000000000000000000000000000000 }, // 47çº§æ–¹å—
            { level: 48, health: 1e148, reward: 1000000000000000000000000000000000000000000000000 }, // 48çº§æ–¹å—
            { level: 49, health: 1e152, reward: 10000000000000000000000000000000000000000000000000 }, // 49çº§æ–¹å—
            { level: 50, health: 1e156, reward: 100000000000000000000000000000000000000000000000000 } ,
            { level: 51, health: 1e160, reward: 1000000000000000000000000000000000000000000000000000 },
            { level: 52, health: 1e164, reward: 10000000000000000000000000000000000000000000000000000 },
            { level: 53, health: 1e168, reward: 100000000000000000000000000000000000000000000000000000 },
            { level: 54, health: 1e172, reward: 1000000000000000000000000000000000000000000000000000000 }// 50çº§æ–¹å—

        ];
        
        // ç‚¼è¯æ–¹å—æ•°æ®
        const alchemyBlocks = [
            { level: 1, health: 1000000, rewardChance: 0.05, rewardType: 'alchemy', baseReward: 1 }, // 1çº§ç‚¼è¯æ–¹å—ï¼Œ100ä¸‡è¡€é‡
            { level: 2, health: 10000000, rewardChance: 0.15, rewardType: 'alchemy', baseReward: 1 }, // 2çº§ç‚¼è¯æ–¹å—ï¼Œ1000ä¸‡è¡€é‡
            { level: 3, health: 500000000, rewardChance: 0.40, rewardType: 'alchemy', baseReward: 1 }, // 3çº§ç‚¼è¯æ–¹å—ï¼Œ5äº¿è¡€é‡
            { level: 4, health: 100000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 1 }, // 4çº§ç‚¼è¯æ–¹å—ï¼Œ1000äº¿è¡€é‡
            { level: 5, health: 500000000000, rewardType: 'alchemy', specialRewards: [0.1, 0.2, 0.3, 0.4] }, // 5çº§ç‚¼è¯æ–¹å—ï¼Œ5000äº¿è¡€é‡
            { level: 6, health: 10000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 5 }, // 6çº§ç‚¼è¯æ–¹å—ï¼Œ10å…†è¡€é‡
            { level: 7, health: 1000000000000000, rewardType: 'alchemy', weightedRewards: [ // 7çº§ç‚¼è¯æ–¹å—ï¼Œ1000å…†è¡€é‡
                { value: 10, weight: 0.50 },  // 50%æ¦‚ç‡è·å¾—10ç‚¼è¯å€¼
                { value: 15, weight: 0.35 },  // 35%æ¦‚ç‡è·å¾—15ç‚¼è¯å€¼
                { value: 20, weight: 0.10 },  // 10%æ¦‚ç‡è·å¾—20ç‚¼è¯å€¼
                { value: 30, weight: 0.05 }   // 5%æ¦‚ç‡è·å¾—30ç‚¼è¯å€¼
            ]},
            { level: 8, health: 10000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 50 }, // 8çº§ç‚¼è¯æ–¹å—ï¼Œ1000äº¬è¡€é‡
            { level: 9, health: 1000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 100 }, // 9çº§ç‚¼è¯æ–¹å—ï¼Œ10å“è¡€é‡
            { level: 10, health: 1000000000000000000000000, rewardType: 'alchemy', weightedRewards: [ // 10çº§ç‚¼è¯æ–¹å—ï¼Œ10æ¼è¡€é‡
                { value: 200, weight: 0.50 },  // 50%æ¦‚ç‡è·å¾—200ç‚¼è¯å€¼
                { value: 300, weight: 0.50 }   // 50%æ¦‚ç‡è·å¾—300ç‚¼è¯å€¼
            ]},
            { level: 11, health: 10000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 512 }, // 11çº§ç‚¼è¯æ–¹å—ï¼Œ1ç©°è¡€é‡
            { level: 12, health: 100000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 1080 }, // 12çº§ç‚¼è¯æ–¹å—ï¼Œ1æ²Ÿè¡€é‡
            { level: 13, health: 1000000000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 2200 }, // 13çº§ç‚¼è¯æ–¹å—ï¼Œ1æ¶§è¡€é‡
            { level: 14, health: 10000000000000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 4600 }, // 14çº§ç‚¼è¯æ–¹å—ï¼Œ1æ­£è¡€é‡
            { level: 15, health: 100000000000000000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 10000 }, // 15çº§ç‚¼è¯æ–¹å—ï¼Œ1è½½è¡€é‡
            { level: 16, health: 1000000000000000000000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 24000 }, // 16çº§ç‚¼è¯æ–¹å—ï¼Œ1æè¡€é‡
            { level: 17, health: 100000000000000000000000000000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 40000 }, // 17çº§ç‚¼è¯æ–¹å—ï¼Œ1é˜¿æ›¾ç¥‡è¡€é‡
            { level: 18, health: 10000000000000000000000000000000000000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 64000 }, // 18çº§ç‚¼è¯æ–¹å—ï¼Œ1ä¸å¯æ€è®®è¡€é‡
            { level: 19, health: 1000000000000000000000000000000000000000000000000000000000000000000000000, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 100000 }, // 19çº§ç‚¼è¯æ–¹å—ï¼Œ1å¤§æ•°è¡€é‡
            { level: 20, health: 1e80, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 140000 }, // 20çº§ç‚¼è¯æ–¹å—ï¼Œ1å…¨ä»•ç¥¥è¡€é‡
            { level: 21, health: 1e88, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 200000 }, // 21çº§ç‚¼è¯æ–¹å—ï¼Œ1ä¸‡å…¨ä»•ç¥¥è¡€é‡
            { level: 22, health: 1e96, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 280000 }, // 22çº§ç‚¼è¯æ–¹å—ï¼Œ1å¤æˆˆå°”è¡€é‡
            { level: 23, health: 1e104, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 380000 }, // 23çº§ç‚¼è¯æ–¹å—ï¼Œ1å¤æˆˆå°”æ™®å‹’å…‹æ–¯è¡€é‡
            { level: 24, health: 1e112, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 540000 }, // 24çº§ç‚¼è¯æ–¹å—ï¼Œ1å¤æˆˆå°”ç±³æ™®å‹’å…‹æ–¯è¡€é‡
            { level: 25, health: 1e120, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 760000 }, // 25çº§ç‚¼è¯æ–¹å—ï¼Œ1è‘›ç«‹æ’æ•°è¡€é‡
            { level: 26, health: 1e128, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 1200000 },
            { level: 27, health: 1e136, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 1700000 },
            { level: 28, health: 1e144, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 2600000 },
            { level: 29, health: 1e152, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 4400000 },
            { level: 30, health: 1e160, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 7200000 },
            { level: 31, health: 1e168, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 11000000 },
            { level: 32, health: 1e172, rewardChance: 1.0, rewardType: 'alchemy', baseReward: 17000000 },
        ];
        
        // ç‰¹æ®Šæ–¹å—æ•°æ®
        const specialBlocks = [
            { id: 1, name: 'é“±å—', health: 10000000000000, dropChance: 0.001, dropItem: 'iridium', dropAmount: 1 }, // 10å…†è¡€é‡
            { id: 2, name: 'é«˜çº¯åº¦é“±å—', health: 10000000000000000, dropChance: 0.1, dropItem: 'iridium', dropAmount: 1 }, // 1äº¬è¡€é‡
            { id: 3, name: 'ç»“æ™¶æ–¹å—', health: 1, type: 'crystal' }, // ç»“æ™¶æ–¹å—ï¼Œè¡€é‡ä¸º1
            { id: 4, name: 'ğ¬­¶å—', health: 100000000000000000000000, dropChance: 0.001, dropItem: 'hassium', dropAmount: 1 }, // 1000å“è¡€é‡
            { id: 5, name: 'é«˜çº¯åº¦ğ¬­¶å—', health: 100000000000000000000000000, dropChance: 0.1, dropItem: 'hassium', dropAmount: 1 }, // 100æ¼è¡€é‡
            { id: 6, name: 'ä½¿ç”¨æ–¹å—', health: 1, type: 'usage_bonus' }, // ä½¿ç”¨æ–¹å—ï¼Œä½¿ç”¨å¢ç›Šåˆ°è¾¾10äº¿ä»¥ä¸Šç‚¹å‡»æ‰æœ‰æ•ˆ
            { id: 7, name: 'ç‰©è´¨æ–¹å—', health: 10000000000000000000000000000000000000000000000000000000000000000, dropChance: 1.0, type: 'matter' }, // 1ä¸å¯æ€è®®è¡€é‡
            { id: 8, name: 'é‡äº§æ ¸å¿ƒ', health: 1e68, type: 'production_core' }, // é‡äº§æ ¸å¿ƒæ–¹å—
            { id: 9, name: 'ç»ˆç„‰æ ¸å¿ƒ', health: 1e124, dropChance: 0.01, dropItem: 'endCore', dropAmount: 1, color: 'black-gradient' }, // 1ç»ˆç„‰æ ¸å¿ƒæ–¹å—ï¼Œ1%æ¦‚ç‡è·å¾—1ç»ˆç„‰æ ¸å¿ƒï¼Œé»‘è‰²æ¸å˜
            { id: 10, name: 'ç»ˆç„‰é›†é˜µ', health: 1e160, specialDropRanges: true, color: 'colorful-gradient', dropRanges: [
                { chance: 0.005, min: 1, max: 100000000 },        // 0.005%æ¦‚ç‡1è‡³1äº¿ï¼ˆé™¤ä»¥10ï¼‰
                { chance: 0.003, min: 100000000, max: 1e16 }, // 0.003%æ¦‚ç‡1äº¿è‡³1äº¬ï¼ˆé™¤ä»¥10ï¼‰
                { chance: 0.0015, min: 1e16, max: 1e24 }, // 0.0015%æ¦‚ç‡1äº¬è‡³1æ¼ï¼ˆé™¤ä»¥10ï¼‰
                { chance: 0.0005, min:1e24, max: 1e32 } // 0.0005%æ¦‚ç‡1æ¼è‡³1æ²Ÿï¼ˆé™¤ä»¥10ï¼‰
            ], blackHoleRanges: [
                { chance: 0.5, min: 1, max: 100000000 },        // 50%æ¦‚ç‡1è‡³1äº¿
                { chance: 0.3, min: 100000000, max:1e16 },
                { chance: 0.15, min: 1e16, max: 1e24 }, // 30%æ¦‚ç‡1äº¿è‡³1äº¬
                { chance: 0.045, min: 1e24, max: 1e32 }, // 4.5%æ¦‚ç‡1äº¬è‡³1æ¼
                { chance: 0.0045, min: 1e32, max: 1e40 }, // 0.45%æ¦‚ç‡10æ¼è‡³1æ²Ÿ
                { chance: 0.0004, min: 1e40, max: 1e48 }, 
                { chance: 0.0001, min: 1e48, max: 1e56 }// 0.05%æ¦‚ç‡1æ²Ÿè‡³1æ­£
            ], dropItem: 'endCore' } // ç»ˆç„‰é›†é˜µæ–¹å—
        ];
        
        // å¥‡ç‚¹æ–¹å—æ•°æ®
        const singularityBlocks = [
            { id: 7, name: '1çº§å¥‡ç‚¹æ–¹å—', health: 100000000000000000000000000000000, dropChance: 0.001, dropItem: 'singularity', dropAmount: 1 }, // 1æ²Ÿè¡€é‡
            { id: 8, name: '2çº§å¥‡ç‚¹æ–¹å—', health: 1000000000000000000000000000000000000, dropChance: 0.01, dropItem: 'singularity', dropAmount: 1 }, // 1æ¶§è¡€é‡
            { id: 9, name: '3çº§å¥‡ç‚¹æ–¹å—', health: 10000000000000000000000000000000000000000, dropChance: 0.1, dropItem: 'singularity', dropAmount: 1 }, // 1æ­£è¡€é‡
            { id: 10, name: '4çº§å¥‡ç‚¹æ–¹å—', health: 100000000000000000000000000000000000000000000, dropChance: 1.0, dropItem: 'singularity', dropAmount: 1 }, // 1è½½è¡€é‡
            { id: 11, name: '5çº§å¥‡ç‚¹æ–¹å—', health: 1000000000000000000000000000000000000000000000000, dropChance: 1.0, dropItem: 'singularity', dropAmount: 10 }, // 1æè¡€é‡ï¼ˆ1e48ï¼‰ï¼Œ100%æ¦‚ç‡è·å¾—10å¥‡ç‚¹
            { id: 12, name: '6çº§å¥‡ç‚¹æ–¹å—', health: 1e80, dropChance: 1.0, dropItem: 'singularity', dropAmount: 10000 },
            { id: 13, name: '7çº§å¥‡ç‚¹æ–¹å—', health: 1e100, dropChance: 1.0, dropItem: 'singularity', dropAmount: 1000000}, 
            { id: 14, name: '8çº§å¥‡ç‚¹æ–¹å—', health: 1e120, dropChance: 1.0, dropItem: 'singularity', dropAmount: 100000000 }, 
            { id: 15, name: '9çº§å¥‡ç‚¹æ–¹å—', health: 1e140, dropChance: 1.0, dropItem: 'singularity', dropAmount: 10000000000 },
            { id: 15, name: 'ç»ˆçº§å¥‡ç‚¹æ–¹å—', health: 1e160, dropChance: 1.0, dropItem: 'singularity', dropAmount: 1000000000000 },
             // 1å¤æˆˆå°”è¡€é‡ï¼Œ100%æ¦‚ç‡è·å¾—10Wå¥‡ç‚¹
        ];

        // æ·»åŠ æ¯ç§’æŒ–çŸ¿æ¬¡æ•°æ˜¾ç¤ºå…ƒç´ åˆ°å³ä¸Šè§’
        const miningPerSecondElement = document.createElement('div');
        miningPerSecondElement.id = 'mining-per-second';
        miningPerSecondElement.className = 'mining-per-second-display';
        miningPerSecondElement.textContent = 'æ¯ç§’æŒ–çŸ¿: 0æ¬¡';
        miningPerSecondElement.style.position = 'absolute';
        miningPerSecondElement.style.top = '10px';
        miningPerSecondElement.style.right = '10px';
        miningPerSecondElement.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
        miningPerSecondElement.style.color = 'white';
        miningPerSecondElement.style.padding = '10px';
        miningPerSecondElement.style.borderRadius = '5px';
        miningPerSecondElement.style.fontWeight = 'bold';
        document.querySelector('.game-container').appendChild(miningPerSecondElement);
        
        // æ·»åŠ èƒ½é‡è½¬åŒ–æŒ‰é’®çš„äº‹ä»¶ç›‘å¬å™¨
        if (convertEnergyButton) {
            convertEnergyButton.addEventListener('click', convertEnergy);
        }
        
        if (convertEnergyMaxButton) {
            convertEnergyMaxButton.addEventListener('click', convertEnergyMax);
        }
        
        // DOMå…ƒç´ 
        const goldElement = document.getElementById('gold');
        const currentPickaxeElement = document.getElementById('current-pickaxe');
        const pickaxeBonusElement = document.getElementById('pickaxe-bonus');
        const usageBonusElement = document.getElementById('usage-bonus');
        const goldBonusElement = document.getElementById('gold-bonus');
        const alchemyBonusElement = document.getElementById('alchemy-bonus');
        const attackDamageElement = document.getElementById('attack-damage');
        const alchemyPointsElement = document.getElementById('alchemy-points');
        const alchemyCrystalsElement = document.getElementById('alchemy-crystals');
        const iridiumIngotsElement = document.getElementById('iridium-ingots');
        const hassiumIngotsElement = document.getElementById('hassium-ingots');
        const matterElement = document.getElementById('matter');
        const energyElement = document.getElementById('energy');
        const energyMultiplierElement = document.getElementById('energy-multiplier');
        const energyMultiplierDisplayElement = document.getElementById('energy-multiplier-display');
        const energyGainRateElement = document.getElementById('energy-gain-rate');
        const productionCoreElement = document.getElementById('production-core');
        const energyBonusElement = document.getElementById('energy-bonus');
        const convertEnergyButton = document.getElementById('convert-energy-btn');
        const convertEnergyMaxButton = document.getElementById('convert-energy-max-btn');
        const mineBlockElement = document.getElementById('mine-block');
        const blockLevelElement = document.querySelector('.block-level');
        const blockHealthElement = document.getElementById('block-health');
        const blockMaxHealthElement = document.getElementById('block-max-health');
        const healthFillElement = document.getElementById('health-fill');
        const blockRewardElement = document.getElementById('block-reward');
        const prevBlockButton = document.getElementById('prev-block');
        const nextBlockButton = document.getElementById('next-block');
        const toggleBlockTypeButton = document.getElementById('toggle-block-type');
        const pickaxeListElement = document.getElementById('pickaxe-list');
        const autoSaveStatusElement = document.getElementById('auto-save-status');
        const miningTabButton = document.getElementById('mining-tab');
        const alchemyTabButton = document.getElementById('alchemy-tab');
        const embeddingTabButton = document.getElementById('embedding-tab');
        const embeddingSystemElement = document.querySelector('.embedding-system');
        const alchemySystemElement = document.querySelector('.alchemy-system');
        const alchemyResultElement = document.getElementById('alchemy-result');
        const batchAlchemyValueElement = document.getElementById('batch-alchemy-value');
        const batchAlchemyTimesElement = document.getElementById('batch-alchemy-times');
        const batchAlchemyButtonElement = document.getElementById('batch-alchemy-btn');
        // æ·¬ç‚¼ç³»ç»Ÿç›¸å…³DOMå…ƒç´ 
        const forgingTabButton = document.getElementById('forging-tab');
        const forgingSystemElement = document.querySelector('.forging-system');
        const forgingCrystalValueElement = document.getElementById('forging-crystal-value');
        const forgingButtonElement = document.getElementById('forging-btn');
        const forgingResultElement = document.getElementById('forging-result');
        const forgingDamageBonusElement = document.getElementById('forging-damage-bonus');
        const forgingUsageBonusElement = document.getElementById('forging-usage-bonus');
        const forgingGoldGainElement = document.getElementById('forging-gold-gain');
        const forgingCrystalBonusElement = document.getElementById('forging-crystal-bonus');

        // å½“å‰æ–¹å—æ•°æ®
        let currentBlock = { ...blocks[gameData.currentBlockIndex] };

        // æ›´æ–°æ¸¸æˆç»Ÿè®¡ä¿¡æ¯
        function updateStats() {
            goldElement.textContent = formatNumber(gameData.gold);
            alchemyPointsElement.textContent = formatNumber(gameData.alchemyPoints);
            alchemyCrystalsElement.textContent = formatNumber(gameData.alchemyCrystals);
            iridiumIngotsElement.textContent = formatNumber(gameData.iridiumIngots);
            hassiumIngotsElement.textContent = formatNumber(gameData.hassiumIngots);
            matterElement.textContent = formatNumber(gameData.matter);
            energyElement.textContent = formatNumber(gameData.energy);
            energyMultiplierElement.textContent = formatNumber(gameData.energyMultiplier);
            energyMultiplierDisplayElement.textContent = formatNumber(gameData.energyMultiplier);
            const energyGainRate = (1 + gameData.productionCore) * gameData.energyMultiplier;
            energyGainRateElement.textContent = formatNumber(energyGainRate);
            productionCoreElement.textContent = formatNumber(gameData.productionCore);
            
            // æ˜¾ç¤ºç»ˆç„‰æ ¸å¿ƒæ•°é‡å’Œç»ˆç„‰å¢ç›Š
            const endCoreElement = document.getElementById('end-core');
            const endBonusElement = document.getElementById('end-bonus');
            if (endCoreElement) endCoreElement.textContent = formatNumber(gameData.endCore);
            if (endBonusElement) {
                const endBonus = 1 + Math.pow(gameData.endCore, Math.exp(1/Math.E));
                endBonusElement.textContent = formatNumber(endBonus) + 'å€';
            }
            
            // æ›´æ–°æ·¬ç‚¼å¢ç›Šæ˜¾ç¤º
            if (gameData.forgingStats) {
                if (forgingDamageBonusElement) {
                    const damageBonus = gameData.forgingStats.damageBonus || 0;
                    forgingDamageBonusElement.textContent = damageBonus >= 100 ? formatNumber(damageBonus) + '%' : damageBonus.toFixed(2) + '%';
                }
                if (forgingUsageBonusElement) {
                    const usageBonus = gameData.forgingStats.usageBonusGain || 0;
                    forgingUsageBonusElement.textContent = usageBonus >= 100 ? formatNumber(usageBonus) + '%' : usageBonus.toFixed(2) + '%';
                }
                if (forgingGoldGainElement) {
                    const goldGain = gameData.forgingStats.goldGain || 0;
                    forgingGoldGainElement.textContent = goldGain >= 100 ? formatNumber(goldGain) + '%' : goldGain.toFixed(2) + '%';
                }
                if (forgingCrystalBonusElement) {
                    const crystalBonus = gameData.forgingStats.crystalBonus || 0;
                    forgingCrystalBonusElement.textContent = crystalBonus >= 100 ? formatNumber(crystalBonus) + '%' : crystalBonus.toFixed(2) + '%';
                }
            }
            
            // è®¡ç®—èƒ½é‡å¢ç›Š: 1 + (èƒ½é‡^(2^(1/3)))
        const energyBonus = 1 + Math.pow(gameData.energy, Math.pow(2, 1/3));
            energyBonusElement.textContent = formatNumber(energyBonus);
            
            // æ›´æ–°ç‚¼è¯ç»“æ™¶é¢„è§ˆå’ŒæŒ‰é’®çŠ¶æ€
              const crystalsPreviewElement = document.getElementById('crystals-preview');
              const crystallizeBtnElement = document.getElementById('crystallize-btn');
              
              if (gameData.alchemyPoints >= 10000) {
                  const crystalsPreview = gameData.alchemyPoints / 10000;
                  crystalsPreviewElement.textContent = crystalsPreview.toFixed(1);
                  crystallizeBtnElement.disabled = false;
              } else {
                  crystalsPreviewElement.textContent = '0.0';
                  crystallizeBtnElement.disabled = true;
              }
            
            const currentPickaxe = pickaxes[gameData.currentPickaxeIndex];
            currentPickaxeElement.textContent = currentPickaxe.name;
            pickaxeBonusElement.textContent = formatNumber(currentPickaxe.bonus) + 'å€';
            usageBonusElement.textContent = formatNumber(gameData.usageBonus) + 'å€';
            alchemyBonusElement.textContent = formatNumber(gameData.alchemyBonus) + 'å€';
            
            // æ›´æ–°å¥‡ç‚¹æ•°é‡æ˜¾ç¤º
            const singularityElement = document.getElementById('embedding-singularity-count');
            if (singularityElement) {
                singularityElement.textContent = formatNumber(gameData.singularity);
            }
            // æ›´æ–°ä¸»ç•Œé¢å¥‡ç‚¹æ•°é‡æ˜¾ç¤º
            const mainSingularityElement = document.getElementById('singularity');
            if (mainSingularityElement) {
                mainSingularityElement.textContent = formatNumber(gameData.singularity);
            }
            
            // è®¡ç®—é‡‘å¸å¢ç›Š: 1 + (é‡‘å¸^0.4) ç”¨äºå€å¢æ”»å‡»åŠ›
            const attackBonus = 1 + Math.pow(gameData.gold, 0.4);
            // è®¡ç®—æ·¬ç‚¼å¢ç›Š: ç”¨äºå€å¢é‡‘å¸è·å–
            const forgingBonus = 1 + gameData.forgingStats.goldGain / 100;
            goldBonusElement.textContent = formatNumber(attackBonus) + 'å€';
            
            // è®¡ç®—æ”»å‡»ä¼¤å®³: ä½¿ç”¨å¢ç›Š * æ”»å‡»åŠ›å¢ç›Š * ç‚¼è¯å¢ç›Š * é•å­å¢ç›Š * æ·¬ç‚¼ä¼¤å®³å¢ç›Š * é•¶åµŒæ”»å‡»å¢ç›Š * é•¶åµŒå…¨å±æ€§å¢ç›Š * èƒ½é‡å¢ç›Š
            // ä¿®å¤å®é™…ä¼¤å®³ä¸æ˜¾ç¤ºä¼¤å®³ä¸ä¸€è‡´çš„é—®é¢˜
            const damageBonus = 1 + gameData.forgingStats.damageBonus / 100;
            const embeddingAttackBonus = calculateEmbeddingBonus(1); // è·å–é•¶åµŒæ”»å‡»å¢ç›Š
            const embeddingAllBonus = calculateEmbeddingBonus(5); // è·å–é•¶åµŒå…¨å±æ€§å¢ç›Š
            // è®¡ç®—èƒ½é‡å¢ç›Šï¼š1 + èƒ½é‡^(2^(1/3))
        const damageEnergyBonus = 1 + Math.pow(gameData.energy, Math.pow(2, 1/3));
            // è®¡ç®—ç»ˆç„‰å¢ç›Šï¼š1 + ç»ˆç„‰æ ¸å¿ƒæ•°é‡^(æ ¹å·2*(e^(1/e)))
            const endBonus = 1 + Math.pow(gameData.endCore, Math.sqrt(2) * Math.exp(1/Math.E));
            const attackDamage = Math.floor(gameData.usageBonus * attackBonus * gameData.alchemyBonus * currentPickaxe.bonus * damageBonus * embeddingAttackBonus * embeddingAllBonus * damageEnergyBonus * endBonus);
            attackDamageElement.textContent = formatNumber(attackDamage);
            
            // æ›´æ–°æ·¬ç‚¼å±æ€§æ˜¾ç¤º
            if (forgingDamageBonusElement) forgingDamageBonusElement.textContent = gameData.forgingStats.damageBonus.toFixed(1) + '%';
            if (forgingUsageBonusElement) forgingUsageBonusElement.textContent = gameData.forgingStats.usageBonusGain.toFixed(1) + '%';
            if (forgingGoldGainElement) forgingGoldGainElement.textContent = gameData.forgingStats.goldGain.toFixed(1) + '%';
            if (forgingCrystalBonusElement) forgingCrystalBonusElement.textContent = gameData.forgingStats.crystalBonusGain.toFixed(1) + '%';
            
            // è·å–å½“å‰æ–¹å—æ•°æ®ï¼ˆæ ¹æ®æ–¹å—ç±»å‹ï¼‰
            const isAlchemy = gameData.currentBlockType === 'alchemy';
            const isSpecial = gameData.currentBlockType === 'special';
            const isSingularity = gameData.currentBlockType === 'singularity';
            
            // æ›´æ–°æ–¹å—ä¿¡æ¯
            if (isAlchemy) {
                blockLevelElement.textContent = `${currentBlock.level}çº§ç‚¼è¯æ–¹å—`;
                blockHealthElement.textContent = formatNumber(currentBlock.health);
                blockMaxHealthElement.textContent = formatNumber(currentBlock.maxHealth || currentBlock.health);
                
                if (currentBlock.weightedRewards) {
                    // 7çº§åŠ æƒæ¦‚ç‡ç‚¼è¯æ–¹å—
                    let rewardText = 'æ‰è½ï¼š';
                    currentBlock.weightedRewards.forEach((reward, index) => {
                        rewardText += `${reward.value}ç‚¼è¯å€¼(${Math.round(reward.weight * 100)}%)`;
                        if (index < currentBlock.weightedRewards.length - 1) {
                              rewardText += ' ';
                          }
                      });
                    blockRewardElement.textContent = rewardText;
                } else if (currentBlock.specialRewards) {
                    // 5çº§ç‰¹æ®Šç‚¼è¯æ–¹å—ï¼Œè¯¦ç»†æ˜¾ç¤ºæ‰è½æ¦‚ç‡
                    let rewardText = 'æ‰è½ï¼š';
                    currentBlock.specialRewards.forEach((weight, index) => {
                        rewardText += `${index + 1}ç‚¼è¯å€¼(${Math.round(weight * 100)}%)`;
                        if (index < currentBlock.specialRewards.length - 1) {
                            rewardText += ' ';
                        }
                    });
                    blockRewardElement.textContent = rewardText;
                } else if (currentBlock.rewardChance && currentBlock.baseReward) {
                    // æ™®é€šç‚¼è¯æ–¹å—
                    blockRewardElement.textContent = `(æ¦‚ç‡ ${Math.round(currentBlock.rewardChance * 100)}%) è·å¾— ${currentBlock.baseReward} ç‚¼è¯å€¼`;
                }
            } else if (isSingularity) {
                blockLevelElement.textContent = currentBlock.name;
                blockHealthElement.textContent = formatNumber(currentBlock.health);
                blockMaxHealthElement.textContent = formatNumber(currentBlock.maxHealth || currentBlock.health);
                blockRewardElement.textContent = `æ‰è½: å¥‡ç‚¹ ${currentBlock.dropAmount}ä¸ª (æ¦‚ç‡: ${(currentBlock.dropChance * 100).toFixed(2)}%)`;
            } else if (isSpecial) {
                blockLevelElement.textContent = `${currentBlock.name} (${currentBlock.id})`;
                blockHealthElement.textContent = formatNumber(currentBlock.health);
                blockMaxHealthElement.textContent = formatNumber(currentBlock.maxHealth || currentBlock.health);
                if (currentBlock.type === 'crystal') {
                    blockRewardElement.textContent = 'ç‚¼è¯å¢ç›Š';
                } else if (currentBlock.type === 'usage_bonus') {
                    // ä½¿ç”¨æ–¹å—ç‰¹æ®Šæ˜¾ç¤º - è®¡ç®—å®é™…å¢ç›Šæ•°å€¼ï¼ˆåŒ…å«æ·¬ç‚¼å¢ç›Šå’Œé•¶åµŒå¢ç›Šï¼‰
                    const currentPickaxe = pickaxes[gameData.currentPickaxeIndex];
                    const baseUsageGain = currentPickaxe.usageBonus || 0;
                    // è®¡ç®—åŸºç¡€100å€å¢ç›Š
                    const baseBonusGain = 100 * baseUsageGain;
                    // æ·»åŠ æ·¬ç‚¼ä½¿ç”¨å¢ç›Š
                    const usageBonusMultiplier = 1 + gameData.forgingStats.usageBonusGain / 100;
                    // æ·»åŠ é•¶åµŒå¢ç›Šï¼ˆä½¿ç”¨å¢ç›Šè·å–å¢ç›Šï¼‰
                    const embeddingUsageBonus = calculateEmbeddingBonus(3);
                    const bonusGain = baseBonusGain * usageBonusMultiplier * embeddingUsageBonus;
                    const formattedBonus = formatNumber(bonusGain);
                    blockRewardElement.innerHTML = `<span style="font-size: 6px; color: #666;">ä½¿ç”¨å¢ç›Š10äº¿ä»¥ä¸Šè§£é”</span>`;
                } else {
                    // æ ¹æ®æ–¹å—çš„dropItemå±æ€§æ˜¾ç¤ºæ­£ç¡®çš„æ‰è½ç‰©å“åç§°
            if (currentBlock.type === 'matter') {
                // æ˜¾ç¤ºç‰©è´¨æ–¹å—çš„è¯¦ç»†æ‰è½æ¦‚ç‡ï¼ŒåŒ…æ‹¬é»‘æ´é•æ•ˆæœ
                blockRewardElement.innerHTML = `æ‰è½: ç‰©è´¨<br>
                    æ™®é€šé•æ‰è½:<br>
                    1ç‰©è´¨: 90%<br>
                    10ç‰©è´¨: 9%<br>
                    100ç‰©è´¨: 0.9%<br>
                    1000ç‰©è´¨: 0.09%<br>
                    10000ç‰©è´¨: 0.01%<br>
                    <br>
                    é»‘æ´é•æ‰è½:<br>
                    1ç‰©è´¨: 10%<br>
                    10ç‰©è´¨: 15%<br>
                    100ç‰©è´¨: 20%<br>
                    1000ç‰©è´¨: 25%<br>
                    10000ç‰©è´¨: 30%`;
            } else if (currentBlock.type === 'production_core') {
                // æ˜¾ç¤ºé‡äº§æ ¸å¿ƒæ–¹å—çš„è¯¦ç»†æ‰è½æ¦‚ç‡ï¼ŒåŒ…æ‹¬é»‘æ´é•æ•ˆæœ
                blockRewardElement.innerHTML = `æ‰è½: é‡äº§æ ¸å¿ƒ<br>
                    æ™®é€šé•æ‰è½:<br>
                    1é‡äº§æ ¸å¿ƒ: 0.9%<br>
                    10é‡äº§æ ¸å¿ƒ: 0.09%<br>
                    100é‡äº§æ ¸å¿ƒ: 0.01%<br>
                    æ— æ‰è½: 99%<br>
                    <br>
                    é»‘æ´é•æ‰è½:<br>
                    1é‡äº§æ ¸å¿ƒ: 90%<br>
                    10é‡äº§æ ¸å¿ƒ: 9%<br>
                    100é‡äº§æ ¸å¿ƒ: 1%`;
            } else {
                let dropItemName;
                if (currentBlock.dropItem === 'iridium') {
                    dropItemName = 'é“±é”­';
                } else if (currentBlock.dropItem === 'hassium') {
                    dropItemName = 'ğ¬­¶é”­';
                } else if (currentBlock.dropItem === 'singularity') {
                    dropItemName = 'å¥‡ç‚¹';
                } else if (currentBlock.dropItem === 'endCore') {
                    dropItemName = 'ç»ˆç„‰æ ¸å¿ƒ';
                    
                    // ç»ˆç„‰é›†é˜µç‰¹æ®Šæ‰è½æ¦‚ç‡æ˜¾ç¤º
                    if (currentBlock.specialDropRanges) {
                        let probabilityText = `æ‰è½: ç»ˆç„‰æ ¸å¿ƒ<br>`;
                        probabilityText += `æ™®é€šé•æ‰è½:<br>`;
                        
                        // æ˜¾ç¤ºæ™®é€šæ‰è½æ¦‚ç‡åŒºé—´
                        currentBlock.dropRanges.forEach((range, index) => {
                            probabilityText += `${index + 1}. ${formatNumber(range.min)}è‡³${formatNumber(range.max)}: ${(range.chance * 100).toFixed(2)}%<br>`;
                        });
                        
                        probabilityText += `é»‘æ´é•æ‰è½:<br>`;
                        // æ˜¾ç¤ºé»‘æ´é•æ‰è½æ¦‚ç‡åŒºé—´
                        currentBlock.blackHoleRanges.forEach((range, index) => {
                            probabilityText += `${index + 1}. ${formatNumber(range.min)}è‡³${formatNumber(range.max)}: ${(range.chance * 100).toFixed(2)}%<br>`;
                        });
                        
                        blockRewardElement.innerHTML = probabilityText;
                    } else {
                        // æ™®é€šç»ˆç„‰æ ¸å¿ƒæ–¹å—
                        blockRewardElement.textContent = `æ‰è½: ${dropItemName} (æ¦‚ç‡: ${(currentBlock.dropChance * 100).toFixed(2)}%)`;
                    }
                } else {
                    blockRewardElement.textContent = `æ‰è½: ${dropItemName} (æ¦‚ç‡: ${(currentBlock.dropChance * 100).toFixed(2)}%)`;
                }
            }
                }
            } else {
                blockLevelElement.textContent = `${currentBlock.level}çº§æ–¹å—`;
                blockHealthElement.textContent = formatNumber(currentBlock.health);
                blockMaxHealthElement.textContent = formatNumber(currentBlock.maxHealth || currentBlock.health);
                blockRewardElement.textContent = `å¥–åŠ±: ${formatNumber(currentBlock.reward)}`;
            }
            
            // æ›´æ–°è¡€é‡æ¡
            const healthPercentage = (currentBlock.health / currentBlock.maxHealth) * 100;
            healthFillElement.style.width = `${healthPercentage}%`;
            
            // æ›´æ–°è¡€é‡æ¡é¢œè‰²
            if (healthPercentage > 60) {
                healthFillElement.style.backgroundColor = '#4CAF50';
            } else if (healthPercentage > 30) {
                healthFillElement.style.backgroundColor = '#FFC107';
            } else {
                healthFillElement.style.backgroundColor = '#F44336';
            }
            
            // æ›´æ–°æ–¹å—é¢œè‰²
            if (isAlchemy) {
                mineBlockElement.className = 'mine-block alchemy-block-color-' + currentBlock.level;
            } else if (currentBlock.color === 'black-gradient') {
                // ç»ˆç„‰æ ¸å¿ƒæ–¹å— - é»‘è‰²æ¸å˜
                mineBlockElement.className = 'mine-block special-block-black-gradient';
            } else if (currentBlock.color === 'colorful-gradient') {
                // ç»ˆç„‰é›†é˜µæ–¹å— - å½©è‰²æ¸å˜
                mineBlockElement.className = 'mine-block special-block-colorful-gradient';
            } else if (isSpecial || isSingularity) {
                mineBlockElement.className = 'mine-block special-block-color-' + currentBlock.id;
            } else {
                mineBlockElement.className = 'mine-block block-color-' + currentBlock.level;
            }
            
            // æ›´æ–°æ§åˆ¶æŒ‰é’®çŠ¶æ€
            if (isAlchemy) {
                prevBlockButton.disabled = gameData.currentAlchemyBlockIndex === 0;
                nextBlockButton.disabled = gameData.currentAlchemyBlockIndex === alchemyBlocks.length - 1;
            } else if (isSingularity) {
                prevBlockButton.disabled = gameData.currentSingularityBlockIndex === 0;
                nextBlockButton.disabled = gameData.currentSingularityBlockIndex === singularityBlocks.length - 1;
            } else if (isSpecial) {
                prevBlockButton.disabled = gameData.currentSpecialBlockIndex === 0;
                nextBlockButton.disabled = gameData.currentSpecialBlockIndex === specialBlocks.length - 1;
            } else {
                prevBlockButton.disabled = gameData.currentBlockIndex === 0;
                nextBlockButton.disabled = gameData.currentBlockIndex === blocks.length - 1;
            }
            
            // æ›´æ–°æ–¹å—ç±»å‹åˆ‡æ¢æŒ‰é’®
            let blockTypeText = 'æ™®é€š';
            if (isAlchemy) blockTypeText = 'ç‚¼è¯';
            if (isSpecial) blockTypeText = 'ç‰¹æ®Š';
            if (isSingularity) blockTypeText = 'å¥‡ç‚¹';
            toggleBlockTypeButton.textContent = `åˆ‡æ¢æ–¹å—ç±»å‹: ${blockTypeText}`;
            
            // æ›´æ–°å•†åº—
            updateShop();
        }
        
        // æ¯ç§’æ›´æ–°æŒ–çŸ¿æ¬¡æ•°ç»Ÿè®¡
        setInterval(() => {
            // æ›´æ–°æ¯ç§’æŒ–çŸ¿æ¬¡æ•°
            gameData.miningPerSecond = gameData.miningCount;
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('mining-per-second').textContent = `æ¯ç§’æŒ–çŸ¿: ${formatNumber(gameData.miningPerSecond)}æ¬¡`;
            // é‡ç½®è®¡æ•°ï¼Œå‡†å¤‡ä¸‹ä¸€ç§’ç»Ÿè®¡
            gameData.miningCount = 0;
        }, 1000);
        
        // è‡ªåŠ¨ä¿å­˜æ¸¸æˆ
        function autoSaveGame() {
            const saveData = {
                gameData: { ...gameData },
                currentBlock: { ...currentBlock }
            };
            
            localStorage.setItem('miningGameSave', JSON.stringify(saveData));
            
            // æ›´æ–°è‡ªåŠ¨ä¿å­˜çŠ¶æ€
            autoSaveStatusElement.textContent = 'è‡ªåŠ¨ä¿å­˜: å·²ä¿å­˜';
            autoSaveStatusElement.style.color = '#4CAF50';
            
            setTimeout(() => {
                autoSaveStatusElement.textContent = 'è‡ªåŠ¨ä¿å­˜: è¿›è¡Œä¸­';
            }, 1000);
        }
        
        // åŠ è½½æ¸¸æˆ
        function loadGame() {
            const savedData = localStorage.getItem('miningGameSave');
            
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                Object.assign(gameData, parsedData.gameData);
                
                // æ ¹æ®å½“å‰æ–¹å—ç±»å‹åŠ è½½æ­£ç¡®çš„æ–¹å—
                if (gameData.currentBlockType === 'alchemy') {
                    currentBlock = { ...alchemyBlocks[gameData.currentAlchemyBlockIndex] };
                } else if (gameData.currentBlockType === 'special') {
                    currentBlock = { ...specialBlocks[gameData.currentSpecialBlockIndex] };
                } else if (gameData.currentBlockType === 'singularity') {
                    currentBlock = { ...singularityBlocks[gameData.currentSingularityBlockIndex] };
                } else {
                    currentBlock = { ...blocks[gameData.currentBlockIndex] };
                }
                
                currentBlock.maxHealth = currentBlock.health;
                updateStats();
                alert('æ¸¸æˆå·²åŠ è½½ï¼');
            } else {
                alert('æ²¡æœ‰æ‰¾åˆ°å­˜æ¡£ï¼');
            }
        }
        
        // åˆ‡æ¢ç³»ç»Ÿæ ‡ç­¾
        function switchTab(tab) {
            // ç§»é™¤æ‰€æœ‰æ ‡ç­¾é¡µçš„æ´»åŠ¨çŠ¶æ€
            miningTabButton.classList.remove('active');
            alchemyTabButton.classList.remove('active');
            if (forgingTabButton) forgingTabButton.classList.remove('active');
            if (embeddingTabButton) embeddingTabButton.classList.remove('active');
            // ç§»é™¤æˆå°±ç³»ç»Ÿæ ‡ç­¾çš„æ´»åŠ¨çŠ¶æ€
            const achievementsTabButton = document.getElementById('achievements-tab');
            if (achievementsTabButton) achievementsTabButton.classList.remove('active');
            
            // éšè—æ‰€æœ‰ç³»ç»Ÿ
            alchemySystemElement.style.display = 'none';
            if (forgingSystemElement) forgingSystemElement.style.display = 'none';
            if (embeddingSystemElement) embeddingSystemElement.style.display = 'none';
            // éšè—æˆå°±ç³»ç»Ÿ
            const achievementsSystemElement = document.getElementById('achievements-system');
            if (achievementsSystemElement) achievementsSystemElement.style.display = 'none';
            
            // æ ¹æ®æ ‡ç­¾é¡µåç§°æ˜¾ç¤ºç›¸åº”ç³»ç»Ÿ
            if (tab === 'mining') {
                miningTabButton.classList.add('active');
                // æ˜¾ç¤ºæŒ–çŸ¿åŒºåŸŸã€é•å­å•†åº—å’Œèƒ½é‡ç³»ç»Ÿ
                const miningAreaElement = document.querySelector('.mining-area');
                const pickaxeShopElement = document.querySelector('.pickaxe-shop');
                const statsElement = document.querySelector('.stats');
                
                if (miningAreaElement) miningAreaElement.style.display = 'block';
                if (pickaxeShopElement) pickaxeShopElement.style.display = 'block';
                if (statsElement) statsElement.style.display = 'block';
            } else if (tab === 'alchemy') {
                alchemyTabButton.classList.add('active');
                alchemySystemElement.style.display = 'block';
            } else if (tab === 'forging' && forgingTabButton && forgingSystemElement) {
                forgingTabButton.classList.add('active');
                forgingSystemElement.style.display = 'block';
            } else if (tab === 'embedding' && embeddingTabButton && embeddingSystemElement) {
                embeddingTabButton.classList.add('active');
                embeddingSystemElement.style.display = 'block';
                updateEmbeddingDisplay();
            }
        }
        
        // åˆ‡æ¢æ–¹å—ç±»å‹
        function toggleBlockType() {
            // å¾ªç¯åˆ‡æ¢ï¼šæ™®é€š -> ç‚¼è¯ -> ç‰¹æ®Š -> å¥‡ç‚¹ -> æ™®é€š
            if (gameData.currentBlockType === 'normal') {
                gameData.currentBlockType = 'alchemy';
            } else if (gameData.currentBlockType === 'alchemy') {
                gameData.currentBlockType = 'special';
            } else if (gameData.currentBlockType === 'special') {
                gameData.currentBlockType = 'singularity';
            } else {
                gameData.currentBlockType = 'normal';
            }
            
            // é‡ç½®å½“å‰æ–¹å—
            if (gameData.currentBlockType === 'alchemy') {
                currentBlock = { ...alchemyBlocks[gameData.currentAlchemyBlockIndex] };
                document.getElementById('toggle-block-type').textContent = 'åˆ‡æ¢æ–¹å—ç±»å‹: ç‚¼è¯';
            } else if (gameData.currentBlockType === 'special') {
                currentBlock = { ...specialBlocks[gameData.currentSpecialBlockIndex] };
                document.getElementById('toggle-block-type').textContent = 'åˆ‡æ¢æ–¹å—ç±»å‹: ç‰¹æ®Š';
            } else if (gameData.currentBlockType === 'singularity') {
                currentBlock = { ...singularityBlocks[gameData.currentSingularityBlockIndex] };
                document.getElementById('toggle-block-type').textContent = 'åˆ‡æ¢æ–¹å—ç±»å‹: å¥‡ç‚¹';
            } else {
                currentBlock = { ...blocks[gameData.currentBlockIndex] };
                document.getElementById('toggle-block-type').textContent = 'åˆ‡æ¢æ–¹å—ç±»å‹: æ™®é€š';
            }
            currentBlock.maxHealth = currentBlock.health;
            
            updateStats();
        }
        
        // æ‰§è¡Œå•æ¬¡ç‚¼è¯
        function doSingleAlchemy(amount) {
            // æ¶ˆè€—ç‚¼è¯å€¼
            gameData.alchemyPoints -= amount;
            
            // ç”Ÿæˆéšæœºæ•°
            const random = Math.random();
            let resultMessage = '';
            let bonusGain = 0;
            
            if (random < 0.5) {
                // 50% æ¦‚ç‡ç‚¸é”…
                resultMessage = 'ç‚¸é”…äº†ï¼';
                bonusGain = 0;
            } else if (random < 0.9) {
                // 40% æ¦‚ç‡è·å¾—åŸºç¡€å¢ç›Š
                const baseGain = Math.pow(amount, 1/3);
                bonusGain = baseGain;
                resultMessage = `è·å¾— ${bonusGain.toFixed(2)} ç‚¼è¯å¢ç›Šï¼`;
            } else if (random < 0.975) {
                // 7.5% æ¦‚ç‡è·å¾—10å€å¢ç›Š
                const baseGain = Math.pow(amount, 1/3);
                bonusGain = 10 * baseGain;
                resultMessage = `10å€å‡ºè´§ï¼è·å¾— ${bonusGain.toFixed(2)} ç‚¼è¯å¢ç›Šï¼`;
            } else {
                // 2.5% æ¦‚ç‡è·å¾—100å€å¢ç›Š
                const baseGain = Math.pow(amount, 1/3);
                bonusGain = 100 * baseGain;
                resultMessage = `100å€å‡ºè´§ï¼ï¼ï¼è·å¾— ${bonusGain.toFixed(2)} ç‚¼è¯å¢ç›Šï¼`;
            }
            
            // æ›´æ–°ç‚¼è¯å¢ç›Š
            gameData.alchemyBonus += bonusGain;
            
            return { resultMessage, bonusGain };
        }
        
        // ç‚¼è¯åŠŸèƒ½å·²ç§»é™¤ï¼Œä»…ä¿ç•™ä¸€é”®ç‚¼è¯
        
        // ä¸€é”®ç‚¼è¯åŠŸèƒ½ï¼ˆä¼˜åŒ–ç‰ˆï¼‰
        function performBatchAlchemy() {
            let batchValue = parseInt(batchAlchemyValueElement.value);
            let batchTimes = parseInt(batchAlchemyTimesElement.value);
            
            // éªŒè¯è¾“å…¥
            if (isNaN(batchValue) || batchValue <= 0) {
                batchValue = 1;
                batchAlchemyValueElement.value = '1';
            }
            
            if (isNaN(batchTimes) || batchTimes <= 0) {
                batchTimes = 1;
                batchAlchemyTimesElement.value = '1';
            } else if (batchTimes > 1000) {
                batchTimes = 1000;
                batchAlchemyTimesElement.value = '1000';
            }
            
            // æ£€æŸ¥ç‚¼è¯å€¼æ˜¯å¦è¶³å¤Ÿï¼Œå¦‚æœä¸è¶³åˆ™è‡ªåŠ¨è°ƒæ•´
            const totalRequired = batchValue * batchTimes;
            if (totalRequired > gameData.alchemyPoints) {
                if (batchTimes === 1) {
                    // å¦‚æœæ¬¡æ•°ä¸º1ï¼Œè°ƒæ•´ç‚¼è¯å€¼
                    batchValue = Math.floor(gameData.alchemyPoints);
                    batchAlchemyValueElement.value = batchValue.toString();
                } else {
                    // å¦‚æœæ¬¡æ•°å¤§äº1ï¼Œè°ƒæ•´æ¬¡æ•°
                    batchTimes = Math.floor(gameData.alchemyPoints / batchValue);
                    if (batchTimes < 1) {
                        batchTimes = 1;
                        batchValue = Math.floor(gameData.alchemyPoints);
                        batchAlchemyValueElement.value = batchValue.toString();
                    }
                    batchAlchemyTimesElement.value = batchTimes.toString();
                }
            }
            
            // ç¡®ä¿è‡³å°‘æœ‰ä¸€æ¬¡ç‚¼è¯
            if (batchValue <= 0 || gameData.alchemyPoints <= 0) {
                alert('ç‚¼è¯å€¼ä¸è¶³ï¼');
                return;
            }
            
            // FPSè®¡æ•°å™¨å®ç°
        let fps = 0;
        let lastTime = performance.now();
        let frameCount = 0;
        
        function updateFPS() {
            const now = performance.now();
            const deltaTime = now - lastTime;
            frameCount++;
            
            // æ¯ç§’é’Ÿæ›´æ–°ä¸€æ¬¡FPSæ˜¾ç¤º
            if (deltaTime >= 1000) {
                fps = Math.round((frameCount * 1000) / deltaTime);
                document.getElementById('fps-counter').textContent = `FPS: ${fps}`;
                
                // é‡ç½®è®¡æ•°å™¨
                frameCount = 0;
                lastTime = now;
            }
            
            // ç»§ç»­ä¸‹ä¸€å¸§
            requestAnimationFrame(updateFPS);
        }
        
        // åœ¨æ¸¸æˆåˆå§‹åŒ–æ—¶å¯åŠ¨FPSè®¡æ•°å™¨
        window.addEventListener('load', function() {
            updateFPS();
        });
        
        // æ‰§è¡Œæ‰¹é‡ç‚¼è¯
            let totalBonus = 0;
            let successCount = 0;
            let tenXCount = 0;
            let hundredXCount = 0;
            
            for (let i = 0; i < batchTimes; i++) {
                const result = doSingleAlchemy(batchValue);
                totalBonus += result.bonusGain;
                
                if (result.resultMessage.includes('ç‚¸é”…') === false) {
                    successCount++;
                    if (result.resultMessage.includes('10å€')) {
                        tenXCount++;
                    } else if (result.resultMessage.includes('100å€')) {
                        hundredXCount++;
                    }
                }
            }
            
            // æ˜¾ç¤ºç»¼åˆç»“æœ
            let batchResultMessage = `ä¸€é”®ç‚¼è¯å®Œæˆï¼å…±è¿›è¡Œ${batchTimes}æ¬¡ç‚¼è¯ã€‚`;
            batchResultMessage += `\næˆåŠŸæ¬¡æ•°: ${successCount}`;
            batchResultMessage += `\nè·å¾—æ€»å¢ç›Š: ${totalBonus.toFixed(2)}`;
            batchResultMessage += `\n10å€å‡ºè´§æ¬¡æ•°: ${tenXCount}`;
            batchResultMessage += `\n100å€å‡ºè´§æ¬¡æ•°: ${hundredXCount}`;
            
            alchemyResultElement.textContent = batchResultMessage;
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            batchAlchemyValueElement.value = '';
            batchAlchemyTimesElement.value = '';
            
            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            updateStats();
        }
        
        // ä¸éœ€è¦å•ç‹¬çš„æŒ–æ˜ç‰¹æ®Šæ–¹å—å‡½æ•°ï¼Œä½¿ç”¨ç»Ÿä¸€çš„mineBlockå‡½æ•°

        // æ›´æ–°å•†åº—æ˜¾ç¤º
        function updateShop() {
            pickaxeListElement.innerHTML = '';
            
            pickaxes.forEach((pickaxe, index) => {
                const isOwned = gameData.ownedPickaxes.includes(index);
                const isCurrent = index === gameData.currentPickaxeIndex;
                
                const pickaxeItem = document.createElement('div');
                pickaxeItem.className = `pickaxe-item ${isOwned ? 'owned' : ''} ${isCurrent ? 'current' : ''}`;
                
                const nameElement = document.createElement('div');
                nameElement.textContent = pickaxe.name;
                
                const bonusElement = document.createElement('div');
                bonusElement.textContent = `å¢ç›Š: ${pickaxe.bonus}`;
                
                const usageElement = document.createElement('div');
                usageElement.textContent = `ä½¿ç”¨å¢ç›Š: ${pickaxe.usageBonus}`;
                
                const costElement = document.createElement('div');
                if (pickaxe.costs) {
                    // å¤šèµ„æºæ¶ˆè€—çš„æƒ…å†µ
                    let costText = 'ä»·æ ¼: ';
                    const costParts = [];
                    pickaxe.costs.forEach(cost => {
                        let resourceName = '';
                        switch(cost.type) {
                            case 'productionCore':
                                resourceName = 'é‡äº§æ ¸å¿ƒ';
                                break;
                            case 'energy':
                                resourceName = 'èƒ½é‡';
                                break;
                            case 'endCore':
                                resourceName = 'ç»ˆç„‰æ ¸å¿ƒ';
                                break;
                            case 'iridiumIngots':
                                resourceName = 'é“±é”­';
                                break;
                            case 'hassiumIngots':
                                resourceName = 'ğ¬­¶é”­';
                                break;
                            case 'singularity':
                                resourceName = 'å¥‡ç‚¹';
                                break;
                            case 'gold':
                                resourceName = 'é‡‘å¸';
                                break;
                            case 'alchemyCrystals':
                                resourceName = 'ç‚¼è¯ç»“æ™¶';
                                break;
                            case 'matter':
                                resourceName = 'ç‰©è´¨';
                                break;
                            case 'usage_bonus':
                                resourceName = 'ä½¿ç”¨å¢ç›Š';
                                break;
                            default:
                                resourceName = cost.type;
                        }
                        costParts.push(`${formatNumber(cost.amount)} ${resourceName}`);
                    });
                    costElement.textContent = costText + costParts.join(' + ');
                } else if (pickaxe.costType === 'iridium') {
                    costElement.textContent = `ä»·æ ¼: ${pickaxe.cost} é“±é”­`;
                } else if (pickaxe.costType === 'hassium') {
                    costElement.textContent = `ä»·æ ¼: ${pickaxe.cost} ğ¬­¶é”­`;
                } else if (pickaxe.costType === 'singularity') {
                    costElement.textContent = `ä»·æ ¼: ${pickaxe.cost} å¥‡ç‚¹`;
                } else if (pickaxe.costType === 'energy') {
                    costElement.textContent = `ä»·æ ¼: ${formatNumber(pickaxe.cost)} èƒ½é‡`;
                } else if (pickaxe.costType === 'usage_bonus') {
                    costElement.textContent = `ä»·æ ¼: ${formatNumber(pickaxe.cost)} ä½¿ç”¨å¢ç›Š`;
                } else if (pickaxe.costType === 'endCore') {
                    costElement.textContent = `ä»·æ ¼: ${pickaxe.cost} ç»ˆç„‰æ ¸å¿ƒ`;
                } else {
                    costElement.textContent = `ä»·æ ¼: ${formatNumber(pickaxe.cost)} é‡‘å¸`;
                }
                
                // æ·»åŠ ç‰¹æ®Šé•å­æè¿°
                if (pickaxe.description) {
                    const descriptionElement = document.createElement('div');
                    descriptionElement.textContent = pickaxe.description;
                    descriptionElement.style.color = '#FFD700';
                    descriptionElement.style.fontSize = '12px';
                    descriptionElement.style.marginTop = '5px';
                    pickaxeItem.appendChild(descriptionElement);
                }
                
                const actionButton = document.createElement('button');
                actionButton.className = 'buy-btn';
                
                if (isOwned) {
                    if (isCurrent) {
                        actionButton.textContent = 'å½“å‰ä½¿ç”¨';
                        actionButton.disabled = true;
                    } else {
                        actionButton.textContent = 'åˆ‡æ¢ä½¿ç”¨';
                        actionButton.addEventListener('click', () => {
                            gameData.currentPickaxeIndex = index;
                            updateStats();
                        });
                    }
                } else {
                    actionButton.textContent = 'è´­ä¹°';
                    
                    // æ£€æŸ¥æ˜¯å¦å¯ä»¥è´­ä¹°
                    let canAfford = false;
                    if (pickaxe.costs) {
                        // å¤šèµ„æºæ¶ˆè€—çš„æ£€æŸ¥
                        canAfford = true;
                        pickaxe.costs.forEach(cost => {
                            switch(cost.type) {
                                case 'productionCore':
                                    if (!(gameData.productionCore >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'energy':
                                    if (!(gameData.energy >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'endCore':
                                    if (!(gameData.endCore >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'iridiumIngots':
                                    if (!(gameData.iridiumIngots >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'hassiumIngots':
                                    if (!(gameData.hassiumIngots >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'singularity':
                                    if (!(gameData.singularity >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'gold':
                                    if (!(gameData.gold >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'alchemyCrystals':
                                    if (!(gameData.alchemyCrystals && gameData.alchemyCrystals >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'matter':
                                    if (!(gameData.matter && gameData.matter >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                case 'usage_bonus':
                                    if (!(gameData.usageBonus >= cost.amount)) {
                                        canAfford = false;
                                    }
                                    break;
                                default:
                                    // æœªçŸ¥èµ„æºç±»å‹ï¼Œé»˜è®¤ä¸ºä¸å¯è´­ä¹°
                                    canAfford = false;
                            }
                        });
                    } else if (pickaxe.costType === 'iridium') {
                        canAfford = gameData.iridiumIngots >= pickaxe.cost;
                    } else if (pickaxe.costType === 'hassium') {
                        canAfford = gameData.hassiumIngots >= pickaxe.cost;
                    } else if (pickaxe.costType === 'singularity') {
                        canAfford = gameData.singularity >= pickaxe.cost;
                    } else if (pickaxe.costType === 'energy') {
                        canAfford = gameData.energy >= pickaxe.cost;
                    } else if (pickaxe.costType === 'usage_bonus') {
                        canAfford = gameData.usageBonus >= pickaxe.cost;
                    } else if (pickaxe.costType === 'endCore') {
                        canAfford = gameData.endCore >= pickaxe.cost;
                    } else {
                        canAfford = gameData.gold >= pickaxe.cost;
                    }
                    actionButton.disabled = !canAfford;
                    
                    actionButton.addEventListener('click', () => {
                        if (canAfford) {
                            // æ‰£é™¤å¯¹åº”è´§å¸
                            if (pickaxe.costs) {
                                // å¤šèµ„æºæ¶ˆè€—çš„æ‰£é™¤
                                pickaxe.costs.forEach(cost => {
                                    switch(cost.type) {
                                        case 'productionCore':
                                            gameData.productionCore -= cost.amount;
                                            break;
                                        case 'energy':
                                            gameData.energy -= cost.amount;
                                            break;
                                        case 'endCore':
                                            gameData.endCore -= cost.amount;
                                            break;
                                        case 'iridiumIngots':
                                            gameData.iridiumIngots -= cost.amount;
                                            break;
                                        case 'hassiumIngots':
                                            gameData.hassiumIngots -= cost.amount;
                                            break;
                                        case 'singularity':
                                            gameData.singularity -= cost.amount;
                                            break;
                                        case 'gold':
                                            gameData.gold -= cost.amount;
                                            break;
                                        case 'alchemyCrystals':
                                            // å‡è®¾alchemyCrystalsåœ¨gameDataä¸­ç›´æ¥å¯ç”¨
                                            if (gameData.alchemyCrystals) {
                                                gameData.alchemyCrystals -= cost.amount;
                                            }
                                            break;
                                        case 'matter':
                                            // å‡è®¾matteråœ¨gameDataä¸­ç›´æ¥å¯ç”¨
                                            if (gameData.matter) {
                                                gameData.matter -= cost.amount;
                                            }
                                            break;
                                        case 'usage_bonus':
                                            gameData.usageBonus -= cost.amount;
                                            break;
                                    }
                                });
                            } else if (pickaxe.costType === 'iridium') {
                        gameData.iridiumIngots -= pickaxe.cost;
                    } else if (pickaxe.costType === 'hassium') {
                        gameData.hassiumIngots -= pickaxe.cost;
                    } else if (pickaxe.costType === 'singularity') {
                        gameData.singularity -= pickaxe.cost;
                    } else if (pickaxe.costType === 'energy') {
                        gameData.energy -= pickaxe.cost;
                    } else if (pickaxe.costType === 'usage_bonus') {
                        gameData.usageBonus -= pickaxe.cost;
                    } else if (pickaxe.costType === 'endCore') {
                        gameData.endCore -= pickaxe.cost;
                    } else {
                        gameData.gold -= pickaxe.cost;
                    }
                            
                            gameData.ownedPickaxes.push(index);
                            gameData.currentPickaxeIndex = index;
                            updateStats();
                        }
                    });
                }
                
                pickaxeItem.appendChild(nameElement);
                pickaxeItem.appendChild(bonusElement);
                pickaxeItem.appendChild(usageElement);
                pickaxeItem.appendChild(costElement);
                pickaxeItem.appendChild(actionButton);
                
                pickaxeListElement.appendChild(pickaxeItem);
            });
        }

        // æŒ–çŸ¿å‡½æ•°
        function mineBlock() {
            // å¢åŠ æŒ–çŸ¿æ¬¡æ•°è®¡æ•°
            gameData.miningCount++;
            // æ¸…é™¤å¯èƒ½å­˜åœ¨çš„å¢ç›Šæ˜¾ç¤ºï¼ˆæ¯æ¬¡ç‚¹å‡»ä»»ä½•æ–¹å—éƒ½ä¼šæ¸…é™¤ï¼‰
            const bonusDisplayElement = document.getElementById('crystal-bonus-display');
            if (bonusDisplayElement) {
                bonusDisplayElement.textContent = '';
            }
            // æ¸…é™¤å¯èƒ½å­˜åœ¨çš„ä½¿ç”¨å¢ç›Šæ˜¾ç¤º
            const usageBonusDisplayElement = document.getElementById('usage-bonus-display');
            if (usageBonusDisplayElement) {
                usageBonusDisplayElement.textContent = '';
            }
            
            const currentPickaxe = pickaxes[gameData.currentPickaxeIndex];
            
            // è®¡ç®—é‡‘å¸å¢ç›Š: 1 + (é‡‘å¸^0.4) ç”¨äºå€å¢æ”»å‡»åŠ›
            const attackBonus = 1 + Math.pow(gameData.gold, 0.4);
            // è®¡ç®—æ·¬ç‚¼å¢ç›Š: ç”¨äºå€å¢é‡‘å¸è·å–
            const forgingBonus = 1 + gameData.forgingStats.goldGain / 100;
            
            // è®¡ç®—æ”»å‡»ä¼¤å®³: ä½¿ç”¨å¢ç›Š * æ”»å‡»åŠ›å¢ç›Š * ç‚¼è¯å¢ç›Š * é•å­å¢ç›Š * æ·¬ç‚¼ä¼¤å®³å¢ç›Š * é•¶åµŒæ”»å‡»å¢ç›Š * é•¶åµŒå…¨å±æ€§å¢ç›Š * èƒ½é‡å¢ç›Š
            // ä¿®å¤å®é™…ä¼¤å®³ä¸æ˜¾ç¤ºä¼¤å®³ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œç¡®ä¿æ˜¾ç¤ºå’Œå®é™…è®¡ç®—ä¸€è‡´
            const damageBonus = 1 + gameData.forgingStats.damageBonus / 100;
            const embeddingAttackBonus = calculateEmbeddingBonus(1); // è·å–é•¶åµŒæ”»å‡»å¢ç›Š
            const embeddingAllBonus = calculateEmbeddingBonus(5); // è·å–é•¶åµŒå…¨å±æ€§å¢ç›Š
            // è®¡ç®—èƒ½é‡å¢ç›Šï¼š1 + (èƒ½é‡^(2^(1/3)))
        const damageEnergyBonus = 1 + Math.pow(gameData.energy, Math.pow(2, 1/3));
        // è®¡ç®—ç»ˆç„‰å¢ç›Šï¼š1 + ç»ˆç„‰æ ¸å¿ƒæ•°é‡^(æ ¹å·2*(e^(1/e)))
        const endBonus = 1 + Math.pow(gameData.endCore, Math.sqrt(2) * Math.exp(1/Math.E));
        
            // ç‰¹æ®Šé•å­å¤„ç†
            let attackDamage = 1; // é»˜è®¤ä¼¤å®³ä¸º1ï¼Œç‰¹æ®Šé•å­å¯èƒ½ä¼šè¦†ç›–è¿™ä¸ªå€¼
            
            if (currentPickaxe.specialType === 'usage') {
                // ä½¿ç”¨é•ï¼šä¼¤å®³å¼ºåˆ¶ä¸º1
                attackDamage = 1;
            } else {
                // æ™®é€šè®¡ç®—ä¼¤å®³
                attackDamage = Math.floor(gameData.usageBonus * attackBonus * gameData.alchemyBonus * currentPickaxe.bonus * damageBonus * embeddingAttackBonus * embeddingAllBonus * damageEnergyBonus * endBonus);
            }
            
            // å‡å°‘æ–¹å—è¡€é‡
            currentBlock.health -= attackDamage;
            
            // å¢åŠ ä½¿ç”¨å¢ç›Šï¼ŒåŒ…å«æ·¬ç‚¼å¢ç›Šå’Œé•¶åµŒå¢ç›Š
            let usageBonusGain = currentPickaxe.usageBonus * (1 + gameData.forgingStats.usageBonusGain / 100);
            const embeddingUsageBonus = calculateEmbeddingBonus(3); // è·å–é•¶åµŒä½¿ç”¨å¢ç›Šè·å–å¢ç›Š
            
            // ä½¿ç”¨é•ç‰¹æ®Šå¤„ç†ï¼šä½¿ç”¨å¢ç›Šä¸ºç›®å‰æœ€å¼ºé•å­ä½¿ç”¨å¢ç›Šçš„100å€
            if (currentPickaxe.specialType === 'usage') {
                // æ‰¾åˆ°æœ€å¼ºçš„ä½¿ç”¨å¢ç›Šï¼ˆä¸åŒ…æ‹¬ç‰¹æ®Šé•å­ï¼‰
                // ä½¿ç”¨å¢ç›Šå›ºå®šä¸º10äº¿ï¼Œä»è€ƒè™‘é”»é€ ç³»ç»Ÿçš„ä½¿ç”¨å¢ç›ŠåŠ æˆ
                usageBonusGain = 1000000000 * (1 + gameData.forgingStats.usageBonusGain / 100);
            }
            
            gameData.usageBonus += usageBonusGain * embeddingUsageBonus * embeddingAllBonus;
            
            // æ£€æŸ¥æ–¹å—æ˜¯å¦è¢«æŒ–ç©º
            if (currentBlock.health <= 0) {
                // æ ¹æ®æ–¹å—ç±»å‹å¤„ç†å¥–åŠ±
                if (gameData.currentBlockType === 'alchemy') {
                    // ç‚¼è¯æ–¹å—
                    const isBlackHolePickaxe = currentPickaxe.specialType === 'black_hole';
                    
                    if (currentBlock.weightedRewards) {
                        let rewardAmount = 0;
                        
                        if (isBlackHolePickaxe) {
                            // é»‘æ´é•ç‰¹æ®Šå¤„ç†ï¼š7çº§ç‚¼è¯æ–¹å—å¿…å®šæ‰è½30ç‚¼è¯å€¼
                            if (currentBlock.level === 7) {
                                rewardAmount = 30;
                            } else if (currentBlock.level === 10) {
                                // 10çº§ç‚¼è¯æ–¹å—å¿…å®šæ‰è½300ç‚¼è¯å€¼
                                rewardAmount = 300;
                            } else {
                                // å…¶ä»–åŠ æƒæ–¹å—é€‰æ‹©æœ€å¤§å€¼
                                let maxReward = 0;
                                currentBlock.weightedRewards.forEach(item => {
                                    if (item.value > maxReward) {
                                        maxReward = item.value;
                                    }
                                });
                                rewardAmount = maxReward;
                            }
                        } else {
                            // æ­£å¸¸éšæœº
                            const random = Math.random();
                            let cumulativeProbability = 0;
                            
                            for (let i = 0; i < currentBlock.weightedRewards.length; i++) {
                                cumulativeProbability += currentBlock.weightedRewards[i].weight;
                                if (random < cumulativeProbability) {
                                    rewardAmount = currentBlock.weightedRewards[i].value;
                                    break;
                                }
                            }
                        }
                        
                        const embeddingAlchemyBonus = calculateEmbeddingBonus(2); // è·å–é•¶åµŒç‚¼è¯å€¼è·å–å¢ç›Š
                        const embeddingAllBonus = calculateEmbeddingBonus(5); // è·å–é•¶åµŒå…¨å±æ€§å¢ç›Š
                        gameData.alchemyPoints += Math.floor(rewardAmount * embeddingAlchemyBonus * embeddingAllBonus);
                    } else if (currentBlock.specialRewards) {
                        // 5çº§ç‰¹æ®Šç‚¼è¯æ–¹å—
                        let rewardAmount = 0;
                        
                        if (isBlackHolePickaxe) {
                            // é»‘æ´é•ï¼š5çº§ç‚¼è¯æ–¹å—å¿…å®šæ‰è½4ç‚¼è¯å€¼
                            rewardAmount = 4;
                        } else {
                            // æ­£å¸¸éšæœº
                            const random = Math.random();
                            let cumulativeProbability = 0;
                            
                            for (let i = 0; i < currentBlock.specialRewards.length; i++) {
                                cumulativeProbability += currentBlock.specialRewards[i];
                                if (random < cumulativeProbability) {
                                    rewardAmount = i + 1;
                                    break;
                                }
                            }
                        }
                        
                        const embeddingAlchemyBonus = calculateEmbeddingBonus(2); // è·å–é•¶åµŒç‚¼è¯å€¼è·å–å¢ç›Š
                        const embeddingAllBonus = calculateEmbeddingBonus(5); // è·å–é•¶åµŒå…¨å±æ€§å¢ç›Š
                        gameData.alchemyPoints += Math.floor(rewardAmount * embeddingAlchemyBonus * embeddingAllBonus);
                    } else {
                        // æ™®é€šç‚¼è¯æ–¹å—
                        const embeddingAlchemyBonus = calculateEmbeddingBonus(2); // è·å–é•¶åµŒç‚¼è¯å€¼è·å–å¢ç›Š
                        const embeddingAllBonus = calculateEmbeddingBonus(5); // è·å–é•¶åµŒå…¨å±æ€§å¢ç›Š
                        
                        if (isBlackHolePickaxe || Math.random() < currentBlock.rewardChance) {
                            gameData.alchemyPoints += Math.floor(currentBlock.baseReward * embeddingAlchemyBonus * embeddingAllBonus);
                        }
                    }
                } else if (gameData.currentBlockType === 'special') {
                    // ç‰¹æ®Šæ–¹å—ï¼ˆå¦‚é“±å—ï¼‰
                    if (currentBlock.type === 'crystal') {
                        // ç»“æ™¶æ–¹å—ï¼šç‚¼è¯å¢ç›Š = ç‚¼è¯ç»“æ™¶ * æ·¬ç‚¼å¢ç›Š
                        const alchemyCrystals = gameData.alchemyCrystals;
                        const crystalBonusGain = gameData.forgingStats.crystalBonusGain;
                        let bonusGain = alchemyCrystals * crystalBonusGain;
                        
                        // æ°¸æ’é•ç‰¹æ®Šæ•ˆæœï¼šç‚¼è¯å¢ç›ŠÃ—10000
                        const isEternalPickaxe = gameData.currentPickaxeIndex === 23; // æ°¸æ’é•çš„ç´¢å¼•
                        if (isEternalPickaxe) {
                            bonusGain *= 10000;
                        }
                        
                        gameData.alchemyBonus += bonusGain;
                        
                        // è·å–å½“å‰æ˜¾ç¤ºçš„åŒºå—å¥åº·ä¿¡æ¯å…ƒç´ 
                        const healthDisplay = document.querySelector('.block-health');
                        
                        if (healthDisplay) {
                            // åˆ›å»ºæˆ–æ›´æ–°å¢ç›Šæ˜¾ç¤ºå…ƒç´ 
                            let bonusDisplayElement = document.getElementById('crystal-bonus-display');
                            if (!bonusDisplayElement) {
                                bonusDisplayElement = document.createElement('div');
                                bonusDisplayElement.id = 'crystal-bonus-display';
                                bonusDisplayElement.style.color = '#4CAF50';
                                bonusDisplayElement.style.fontWeight = 'bold';
                                healthDisplay.after(bonusDisplayElement);
                            }
                            
                            // è®¾ç½®å¢ç›Šæ˜¾ç¤ºæ–‡æœ¬ï¼Œä½¿ç”¨æ ¼å¼åŒ–æ•°å€¼
                            bonusDisplayElement.textContent = `ç‚¼è¯å¢ç›Š +${formatNumber(bonusGain)}`;
                            
                            // æ·»åŠ é—ªçƒåŠ¨ç”»æ•ˆæœ
                            bonusDisplayElement.style.animation = 'none';
                            void bonusDisplayElement.offsetWidth; // è§¦å‘é‡ç»˜
                            bonusDisplayElement.style.animation = 'highlight 1s ease-in-out';
                            
                            // æ·»åŠ CSSåŠ¨ç”»ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
                            if (!document.getElementById('crystal-bonus-animation')) {
                                const style = document.createElement('style');
                                style.id = 'crystal-bonus-animation';
                                style.textContent = `
                                    @keyframes highlight {
                                        0% { opacity: 0.5; transform: scale(1); }
                                        50% { opacity: 1; transform: scale(1.05); }
                                        100% { opacity: 1; transform: scale(1); }
                                    }
                                `;
                                document.head.appendChild(style);
                            }
                        }
                    } else if (currentBlock.type === 'matter') {
                        // ç‰©è´¨æ–¹å—ï¼šæ ¹æ®æ¦‚ç‡æ‰è½ä¸åŒæ•°é‡çš„ç‰©è´¨
                        let matterAmount = 0;
                        
                        if (currentPickaxe.specialType === 'black_hole') {
                            // é»‘æ´é•ç‰¹æ®Šæ‰è½ï¼š10%æ¦‚ç‡æ‰è½1ç‰©è´¨ï¼Œ15%æ¦‚ç‡æ‰è½10ç‰©è´¨ï¼Œ20ï¼…æ¦‚ç‡æ‰è½100ç‰©è´¨ï¼Œ25ï¼…æ¦‚ç‡æ‰è½1000ç‰©è´¨ï¼Œ30ï¼…æ¦‚ç‡æ‰è½1Wç‰©è´¨
                            const random = Math.random();
                            if (random < 0.1) {
                                matterAmount = 1;
                            } else if (random < 0.25) {
                                matterAmount = 10;
                            } else if (random < 0.45) {
                                matterAmount = 100;
                            } else if (random < 0.7) {
                                matterAmount = 1000;
                            } else {
                                matterAmount = 10000;
                            }
                        } else {
                            // æ™®é€šæ‰è½
                            const random = Math.random();
                            if (random < 0.9) {
                                matterAmount = 1;
                            } else if (random < 0.99) {
                                matterAmount = 10;
                            } else if (random < 0.999) {
                                matterAmount = 100;
                            } else if (random < 0.9999) {
                                matterAmount = 1000;
                            } else {
                                matterAmount = 10000;
                            }
                        }
                        // æ°¸æ’é•ç‰¹æ®Šæ•ˆæœï¼šç‰©è´¨Ã—100000000
                        const isEternalPickaxe = gameData.currentPickaxeIndex === 23;
                        if (isEternalPickaxe) {
                            matterAmount *= 100000000;
                        }
                        gameData.matter += matterAmount;
                    } else if (currentBlock.type === 'production_core') {
                        // é‡äº§æ ¸å¿ƒæ–¹å—ï¼šæ ¹æ®æ¦‚ç‡æ‰è½ä¸åŒæ•°é‡çš„é‡äº§æ ¸å¿ƒ
                        let coreAmount = 0;
                        
                        if (currentPickaxe.specialType === 'black_hole') {
                            // é»‘æ´é•ç‰¹æ®Šæ‰è½ï¼š90æ¦‚ç‡æ‰è½1æ ¸å¿ƒï¼Œ9æ¦‚ç‡10æ ¸å¿ƒï¼Œ1æ¦‚ç‡100æ ¸å¿ƒ
                            const random = Math.random();
                            if (random < 0.9) {
                                coreAmount = 1;
                            } else if (random < 0.99) {
                                coreAmount = 10;
                            } else {
                                coreAmount = 100;
                            }
                        } else {
                            // æ™®é€šæ‰è½
                            const random = Math.random();
                            if (random < 0.009) {
                                coreAmount = 1;
                            } else if (random < 0.0099) {
                                coreAmount = 10;
                            } else if (random < 0.01) {
                                coreAmount = 100;
                            }
                        }
                        // æ°¸æ’é•ç‰¹æ®Šæ•ˆæœï¼šé‡äº§æ ¸å¿ƒÃ—1000000
                        const isEternalPickaxe = gameData.currentPickaxeIndex === 23;
                        if (isEternalPickaxe) {
                            coreAmount *= 1000000;
                        }
                        gameData.productionCore += coreAmount;
                    } else if (currentBlock.type === 'usage_bonus') {
                        // ä½¿ç”¨æ–¹å—ï¼šå½“ä½¿ç”¨å¢ç›Šåˆ°è¾¾10äº¿ä»¥ä¸Šç‚¹å‡»æ‰æœ‰æ•ˆï¼Œç‚¹å‡»è·å¾—100å€æ¯æ¬¡æŒ–çŸ¿è·å¾—çš„ä½¿ç”¨å¢ç›Š
                        if (gameData.usageBonus >= 1000000000) {
                            // è®¡ç®—æ¯æ¬¡æŒ–çŸ¿è·å¾—çš„åŸºç¡€ä½¿ç”¨å¢ç›Šï¼ˆæ ¹æ®é•å­ï¼‰
                            const currentPickaxe = pickaxes[gameData.currentPickaxeIndex];
                            const baseUsageGain = currentPickaxe.usageBonus;
                            // è®¡ç®—100å€å¢ç›Š
                            const baseBonusGain = 100 * baseUsageGain;
                            // æ·»åŠ æ·¬ç‚¼ä½¿ç”¨å¢ç›Š
                            const usageBonusMultiplier = 1 + gameData.forgingStats.usageBonusGain / 100;
                            // æ·»åŠ é•¶åµŒå¢ç›Šï¼ˆä½¿ç”¨å¢ç›Šè·å–å¢ç›Šï¼‰
                            const embeddingUsageBonus = calculateEmbeddingBonus(3);
                            const embeddingAllBonus = calculateEmbeddingBonus(5); // è·å–é•¶åµŒå…¨å±æ€§å¢ç›Š
                            const bonusGain = baseBonusGain * usageBonusMultiplier * embeddingUsageBonus * embeddingAllBonus;
                            // å¢åŠ ä½¿ç”¨å¢ç›Š
                            gameData.usageBonus += bonusGain;
                            
                            // è·å–å½“å‰æ˜¾ç¤ºçš„åŒºå—å¥åº·ä¿¡æ¯å…ƒç´ 
                            const healthDisplay = document.querySelector('.block-health');
                            
                            if (healthDisplay) {
                                // åˆ›å»ºæˆ–æ›´æ–°ä½¿ç”¨å¢ç›Šæ˜¾ç¤ºå…ƒç´ 
                                let usageBonusDisplayElement = document.getElementById('usage-bonus-display');
                                if (!usageBonusDisplayElement) {
                                    usageBonusDisplayElement = document.createElement('div');
                                    usageBonusDisplayElement.id = 'usage-bonus-display';
                                    usageBonusDisplayElement.style.color = '#FF9800';
                                    usageBonusDisplayElement.style.fontWeight = 'bold';
                                    healthDisplay.after(usageBonusDisplayElement);
                                }
                                
                                // è®¾ç½®ä½¿ç”¨å¢ç›Šæ˜¾ç¤ºæ–‡æœ¬ï¼Œä½¿ç”¨æ ¼å¼åŒ–æ•°å€¼
                                usageBonusDisplayElement.textContent = `ä½¿ç”¨å¢ç›Š +${formatNumber(bonusGain)}`;
                                
                                // æ·»åŠ é—ªçƒåŠ¨ç”»æ•ˆæœ
                                usageBonusDisplayElement.style.animation = 'none';
                                void usageBonusDisplayElement.offsetWidth; // è§¦å‘é‡ç»˜
                                usageBonusDisplayElement.style.animation = 'highlight 1s ease-in-out';
                            }
                        }
                    } else {
                        // æ™®é€šç‰¹æ®Šæ–¹å—ï¼ˆå¦‚é“±å—ã€ğ¬­¶å—ï¼‰
                        
                        // é»‘æ´é•ä½¿æ‰€æœ‰æ¦‚ç‡æ‰è½ç‰©å“å˜ä¸ºå¿…å‡º
                        if (currentPickaxe.specialType === 'black_hole' || Math.random() < currentBlock.dropChance) {
                            // æ ¹æ®æ–¹å—ç±»å‹æ‰è½ä¸åŒç‰©å“
                            if (currentBlock.dropItem === 'iridium') {
                                gameData.iridiumIngots += currentBlock.dropAmount;
                            } else if (currentBlock.dropItem === 'hassium') {
                                gameData.hassiumIngots += currentBlock.dropAmount;
                            } else if (currentBlock.dropItem === 'singularity') {
                                gameData.singularity += currentBlock.dropAmount;
                            } else if (currentBlock.dropItem === 'endCore') {
                                // ç»ˆç„‰é›†é˜µç‰¹æ®Šæ‰è½å¤„ç†
                                if (currentBlock.specialDropRanges) {
                                    const random = Math.random();
                                    const ranges = currentPickaxe.specialType === 'black_hole' ? currentBlock.blackHoleRanges : currentBlock.dropRanges;
                                    
                                    let cumulativeChance = 0;
                                    for (const range of ranges) {
                                        cumulativeChance += range.chance;
                                        if (random < cumulativeChance) {
                                            // åœ¨å½“å‰åŒºé—´å†…ç”Ÿæˆéšæœºæ•°é‡
                                            const dropAmount = Math.floor(Math.random() * (range.max - range.min + 1)) + range.min;
                                            // æ°¸æ’é•ä¸åŠ æˆç»ˆç„‰é›†é˜µ
                                            gameData.endCore += dropAmount;
                                            break;
                                        }
                                    }
                                } else if (currentBlock.minDropAmount !== undefined && currentBlock.maxDropAmount !== undefined) {
                                    // æ™®é€šéšæœºæ‰è½æ•°é‡
                                    const dropAmount = Math.floor(Math.random() * (currentBlock.maxDropAmount - currentBlock.minDropAmount + 1)) + currentBlock.minDropAmount;
                                    gameData.endCore += dropAmount;
                                } else {
                                    gameData.endCore += currentBlock.dropAmount;
                                }
                            }
                        }
                    }
                    // æ›´æ–°UIæ˜¾ç¤ºï¼Œç¡®ä¿ç”¨æˆ·èƒ½çœ‹åˆ°æ¯æ¬¡è·å¾—çš„ç‚¼è¯å¢ç›Š
                    updateStats();
                } else if (gameData.currentBlockType === 'singularity') {
                    // å¥‡ç‚¹æ–¹å—ç‰¹æ®Šå¤„ç†ï¼Œç¡®ä¿ä¸è¿›å…¥æ™®é€šæ–¹å—çš„é‡‘å¸å¥–åŠ±é€»è¾‘
                    // å¥‡ç‚¹æ–¹å—å¯èƒ½æœ‰è‡ªå·±çš„æ‰è½æœºåˆ¶æˆ–ç‰¹æ®Šå¥–åŠ±
                    if (currentBlock.dropChance) {
                        // é»‘æ´é•ä½¿æ‰€æœ‰æ¦‚ç‡æ‰è½ç‰©å“å˜ä¸ºå¿…å‡º
                        if (currentPickaxe.specialType === 'black_hole' || Math.random() < currentBlock.dropChance) {
                            if (currentBlock.dropAmount) {
                                    let singularityAmount = currentBlock.dropAmount;
                                    // æ°¸æ’é•ç‰¹æ®Šæ•ˆæœï¼šå¥‡ç‚¹è·å–Ã—100000
                                    const isEternalPickaxe = gameData.currentPickaxeIndex === 23;
                                    if (isEternalPickaxe) {
                                        singularityAmount *= 100000;
                                    }
                                    gameData.singularity += singularityAmount;
                                    // ç§»é™¤è·å¾—å¥‡ç‚¹çš„æç¤ºæ–‡æœ¬ï¼Œåªåœ¨æ–¹å—UIä¸Šæ˜¾ç¤º
                                }
                        }
                    }
                } else {
                    // æ™®é€šæ–¹å—ï¼Œè·å¾—é‡‘å¸å¥–åŠ±ï¼ŒåŒ…å«æ·¬ç‚¼å¢ç›Šå’Œé•¶åµŒå¢ç›Š
                    const embeddingGoldBonus = calculateEmbeddingBonus(4); // è·å–é•¶åµŒé‡‘å¸è·å–å¢ç›Š
                    const embeddingAllBonus = calculateEmbeddingBonus(5); // è·å–é•¶åµŒå…¨å±æ€§å¢ç›Š
                    let goldReward = Math.floor(currentBlock.reward * forgingBonus * embeddingGoldBonus * embeddingAllBonus);
                    
                    // æ°¸æ’é•ç‰¹æ®Šæ•ˆæœï¼šé‡‘å¸Ã—1000000
                    const isEternalPickaxe = gameData.currentPickaxeIndex === 23;
                    if (isEternalPickaxe) {
                        goldReward *= 1000000;
                    }
                    
                    gameData.gold += goldReward;
                }
                
                // é‡ç½®æ–¹å—
                if (gameData.currentBlockType === 'alchemy') {
                    currentBlock = { ...alchemyBlocks[gameData.currentAlchemyBlockIndex] };
                } else if (gameData.currentBlockType === 'special') {
                    currentBlock = { ...specialBlocks[gameData.currentSpecialBlockIndex] };
                } else if (gameData.currentBlockType === 'singularity') {
                    currentBlock = { ...singularityBlocks[gameData.currentSingularityBlockIndex] };
                } else {
                    currentBlock = { ...blocks[gameData.currentBlockIndex] };
                }
                currentBlock.maxHealth = currentBlock.health;
            }
            
            // æ›´æ–°æ¸¸æˆçŠ¶æ€å’Œç»Ÿè®¡ä¿¡æ¯
            updateStats();
        }

        // åˆ‡æ¢åˆ°ä¸Šä¸€çº§æ–¹å—
        function prevBlock() {
            if (gameData.currentBlockType === 'alchemy') {
                if (gameData.currentAlchemyBlockIndex > 0) {
                    gameData.currentAlchemyBlockIndex--;
                    currentBlock = { ...alchemyBlocks[gameData.currentAlchemyBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            } else if (gameData.currentBlockType === 'singularity') {
                if (gameData.currentSingularityBlockIndex > 0) {
                    gameData.currentSingularityBlockIndex--;
                    currentBlock = { ...singularityBlocks[gameData.currentSingularityBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            } else if (gameData.currentBlockType === 'special') {
                if (gameData.currentSpecialBlockIndex > 0) {
                    gameData.currentSpecialBlockIndex--;
                    currentBlock = { ...specialBlocks[gameData.currentSpecialBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            } else {
                if (gameData.currentBlockIndex > 0) {
                    gameData.currentBlockIndex--;
                    currentBlock = { ...blocks[gameData.currentBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            }
        }

        // ç‚¼è¯ç»“æ™¶åŠŸèƒ½
        function createAlchemyCrystals() {
            if (gameData.alchemyPoints >= 10000) {
                // è®¡ç®—è·å¾—çš„ç‚¼è¯ç»“æ™¶ï¼š(ç‚¼è¯å€¼/10000)ï¼Œä¿ç•™ä¸€ä½å°æ•°
                const crystalsGained = gameData.alchemyPoints / 10000;
                const roundedCrystals = Math.round(crystalsGained * 10) / 10; // ä¿ç•™ä¸€ä½å°æ•°
                
                // å¢åŠ ç‚¼è¯ç»“æ™¶å¹¶å°†ç‚¼è¯å€¼å½’é›¶
                gameData.alchemyCrystals += roundedCrystals;
                gameData.alchemyPoints = 0;
                
                // æ›´æ–°UIæ˜¾ç¤ºç»“æœ
                updateStats();
            }
        }
        
        // èƒ½é‡è½¬åŒ–ç›¸å…³åŠŸèƒ½
        // åˆ›å»ºèƒ½é‡å€é€Ÿæå‡é€šçŸ¥
        function createEnergyMultiplierNotification(amount) {
            const energyElement = document.getElementById('energy');
            if (energyElement) {
                const notification = document.createElement('div');
                notification.textContent = `+${amount} èƒ½é‡å€é€Ÿ`;
                notification.style.position = 'absolute';
                notification.style.color = '#4CAF50';
                notification.style.fontWeight = 'bold';
                notification.style.fontSize = '14px';
                notification.style.zIndex = '1000';
                notification.style.pointerEvents = 'none';
                
                const rect = energyElement.getBoundingClientRect();
                notification.style.left = `${rect.left + rect.width / 2}px`;
                notification.style.top = `${rect.top}px`;
                document.body.appendChild(notification);
                
                // åŠ¨ç”»æ•ˆæœ
                let pos = 0;
                const interval = setInterval(() => {
                    pos += 1;
                    notification.style.transform = `translate(-50%, -${pos}px)`;
                    if (pos > 50) {
                        clearInterval(interval);
                        document.body.removeChild(notification);
                    }
                }, 10);
            }
        }
        
        // è½¬åŒ–èƒ½é‡åŠŸèƒ½
        function convertEnergy() {
            const matterCost = 1000000; // 100ä¸‡ç‰©è´¨
            if (gameData.matter >= matterCost) {
                gameData.matter -= matterCost;
                gameData.energyMultiplier += 1; // æ¯100ä¸‡ç‰©è´¨æå‡1èƒ½é‡å€é€Ÿ
                updateStats();
                createEnergyMultiplierNotification(1);
            }
        }
        
        // ä¸€é”®æå‡èƒ½é‡å€é€ŸåŠŸèƒ½
        function convertEnergyMax() {
            const matterCost = 1000000; // 100ä¸‡ç‰©è´¨
            const maxUpgrades = Math.floor(gameData.matter / matterCost);
            if (maxUpgrades > 0) {
                gameData.matter -= maxUpgrades * matterCost;
                gameData.energyMultiplier += maxUpgrades;
                updateStats();
                createEnergyMultiplierNotification(maxUpgrades);
            }
        }

        // åˆ‡æ¢åˆ°ä¸‹ä¸€çº§æ–¹å—
        function nextBlock() {
            if (gameData.currentBlockType === 'alchemy') {
                if (gameData.currentAlchemyBlockIndex < alchemyBlocks.length - 1) {
                    gameData.currentAlchemyBlockIndex++;
                    currentBlock = { ...alchemyBlocks[gameData.currentAlchemyBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            } else if (gameData.currentBlockType === 'singularity') {
                if (gameData.currentSingularityBlockIndex < singularityBlocks.length - 1) {
                    gameData.currentSingularityBlockIndex++;
                    currentBlock = { ...singularityBlocks[gameData.currentSingularityBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            } else if (gameData.currentBlockType === 'special') {
                if (gameData.currentSpecialBlockIndex < specialBlocks.length - 1) {
                    gameData.currentSpecialBlockIndex++;
                    currentBlock = { ...specialBlocks[gameData.currentSpecialBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            } else {
                if (gameData.currentBlockIndex < blocks.length - 1) {
                    gameData.currentBlockIndex++;
                    currentBlock = { ...blocks[gameData.currentBlockIndex] };
                    currentBlock.maxHealth = currentBlock.health;
                    updateStats();
                }
            }
        }

        // æ˜¾ç¤ºæ‰è½é€šçŸ¥
        function showDropNotification(itemName, amount) {
            const notification = document.createElement('div');
            notification.className = 'drop-notification';
            notification.textContent = `è·å¾—äº† ${amount} ä¸ª${itemName}ï¼`;
            notification.style.position = 'fixed';
            notification.style.top = '50%';
            notification.style.left = '50%';
            notification.style.transform = 'translate(-50%, -50%)';
            notification.style.backgroundColor = 'rgba(0, 128, 0, 0.8)';
            notification.style.color = 'white';
            notification.style.padding = '10px 20px';
            notification.style.borderRadius = '5px';
            notification.style.zIndex = '1000';
            notification.style.fontSize = '18px';
            notification.style.fontWeight = 'bold';
            notification.style.opacity = '0';
            notification.style.transition = 'opacity 0.3s, transform 0.3s';
            
            document.body.appendChild(notification);
            
            // æ˜¾ç¤ºåŠ¨ç”»
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translate(-50%, -60%)';
            }, 10);
            
            // 3ç§’åéšè—å¹¶ç§»é™¤
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -70%)';
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 300);
            }, 2700);
        }
        
        // æ ¼å¼åŒ–å¤§æ•°å­—æ˜¾ç¤º
        function formatNumber(num) {
            // ç¡®ä¿numæ˜¯æ•°å­—
            if (typeof num !== 'number' || isNaN(num)) {
                return '0.0';
            }
            
            if (num < 10000) {
                // å°äº10000çš„æ•°å­—ä¹Ÿä¿ç•™ä¸€ä½å°æ•°
                return num.toFixed(1);
            }
            
            const units = ['ä¸‡', 'äº¿', 'å…†', 'äº¬', 'å“', 'æ¼', 'ç©°', 'æ²Ÿ', 'æ¶§', 'æ­£', 'è½½', 'æ', 
                         'æ’æ²³æ²™', 'é˜¿æ›¾ç¥‡', 'é‚£ç”±ä»–', 'ä¸å¯æ€è®®', 'æ— é‡', 'å¤§æ•°', 'å…¨ä»•ä½¯', 'é¢‘æ³¢ç½—', 
                         'äº¬æ°ç½—', 'çŸœç¾¯ç½—', 'ä¸‡çŸœç¾¯ç½—', 'äº¿çŸœç¾¯ç½—', 'å¤æˆˆå°”','ä¸‡å¤æˆˆå°”','äº¿å¤æˆˆå°”','å…†å¤æˆˆå°”','äº¬å¤æˆˆå°”','å“å¤æˆˆå°”','æ¼å¤æˆˆå°”','ç©°å¤æˆˆå°”','æ²Ÿå¤æˆˆå°”','æ¶§å¤æˆˆå°”','æ­£å¤æˆˆå°”','è½½å¤æˆˆå°”','æå¤æˆˆå°”','ä¸å¯è¯´ä¸å¯è¯´è½¬','å…ƒã€‡','å…ƒä¸€','å…ƒäºŒ','å…ƒä¸‰','å…ƒäº–','å…ƒã…','å…ƒÎ»','å…ƒä¸ƒ','å…ƒä¸·','å…ƒå¹','å…ƒå','å…ƒå»¿','å…ƒå…','å…ƒåŒ','å…ƒç™¾','å…ƒåƒ','å…ƒä¸‡','å…ƒäº¿','å…ƒå…†','å…ƒäº¬','å…ƒå“','å…ƒæ¼','å…ƒç©°','å…ƒæ²Ÿ','å…ƒæ¶§','å…ƒæ­£','å…ƒè½½','å…ƒæ','å…ƒæ’æ²³æ²™','å…ƒé˜¿æ›¾ç¥‡','å…ƒé‚£ç”±ä»–','å…ƒä¸å¯æ€è®®','å…ƒæ— é‡','å…ƒå¤§æ•°','å…ƒé¢‘æ³¢ç½—','å…ƒäº¬æ°ç½—','å…ƒçŸœç¾¯ç½—','å…ƒå¤æˆˆå°”','å…ƒåï¼ˆé€šå…³ï¼ï¼ï¼ï¼‰'];
            let unitIndex = 0;
            let currentNum = num;
            
            // å•ä½åˆ‡æ¢é˜ˆå€¼ä¸º10000ï¼Œ10000è¿›åˆ¶
            while (unitIndex < units.length && currentNum >= 10000) {
                currentNum /= 10000;
                unitIndex++;
            }
            
            // ç¡®ä¿è¿”å›æ­£ç¡®çš„å•ä½è¡¨ç¤ºï¼Œæ‰€æœ‰æ•°å­—éƒ½ä¿ç•™ä¸€ä½å°æ•°
            if (unitIndex > 0) {
                return currentNum.toFixed(1) + units[unitIndex - 1];
            }
            
            // æ²¡æœ‰ä½¿ç”¨å•ä½æ—¶ç›´æ¥è¿”å›æ•°å­—
            return currentNum.toFixed(1);
        }

        // è‡ªåŠ¨æŒ–çŸ¿åŠŸèƒ½
        let autoMiningFrameId; // ä½¿ç”¨requestAnimationFrame ID
        
        function toggleAutoMining() {
            gameData.autoMiningEnabled = !gameData.autoMiningEnabled;
            const autoMiningButton = document.getElementById('auto-mining-btn');
            
            if (gameData.autoMiningEnabled) {
                autoMiningButton.textContent = 'å…³é—­è‡ªåŠ¨æŒ–çŸ¿';
                autoMiningButton.style.backgroundColor = '#f44336';
                
                // ä½¿ç”¨requestAnimationFrameå®ç°æœ€é«˜æ€§èƒ½çš„è‡ªåŠ¨æŒ–çŸ¿
                function mineAsFastAsPossible() {
                    if (gameData.autoMiningEnabled) {
                        mineBlock();
                        autoMiningFrameId = requestAnimationFrame(mineAsFastAsPossible);
                    }
                }
                mineAsFastAsPossible();
            } else {
                autoMiningButton.textContent = 'å¼€å¯è‡ªåŠ¨æŒ–çŸ¿';
                autoMiningButton.style.backgroundColor = '#4CAF50';
                
                if (autoMiningFrameId) {
                    cancelAnimationFrame(autoMiningFrameId);
                }
            }
        }
        
        // åœ¨DOMåŠ è½½å®Œæˆåæ·»åŠ è‡ªåŠ¨æŒ–çŸ¿æŒ‰é’®
        document.addEventListener('DOMContentLoaded', () => {
            const blockControls = document.querySelector('.block-controls');
            const autoMiningButton = document.createElement('button');
            autoMiningButton.id = 'auto-mining-btn';
            autoMiningButton.className = 'control-btn';
            autoMiningButton.textContent = 'å¼€å¯è‡ªåŠ¨æŒ–çŸ¿';
            autoMiningButton.addEventListener('click', toggleAutoMining);
            blockControls.appendChild(autoMiningButton);
            
            // å¯åŠ¨è‡ªåŠ¨èƒ½é‡è·å–
            setInterval(() => {
                // å½“èƒ½é‡å€é€Ÿå¤§äº0æ—¶è¡¨ç¤ºå·²è§£é”è‡ªåŠ¨èƒ½é‡è·å–
                if (gameData.energyMultiplier > 0) {
                    const energyGain = (1 + gameData.productionCore) * gameData.energyMultiplier;
                    gameData.energy += energyGain;
                    updateStats();
                }
            }, 100); // æ¯0.1ç§’æ‰§è¡Œä¸€æ¬¡
        });
        
        // æ·¬ç‚¼åŠŸèƒ½
        // é•¶åµŒç³»ç»Ÿ
function updateEmbeddingDisplay() {
    for (let i = 0; i < gameData.embeddingBlocks.length; i++) {
        const block = gameData.embeddingBlocks[i];
        const countElement = document.getElementById(`embedding-count-${i}`);
        const bonusElement = document.getElementById(`embedding-bonus-${i}`);
        
        if (countElement) countElement.textContent = formatNumber(block.count);
        if (bonusElement) {
            const bonus = calculateEmbeddingBonus(i+1);
            // å¯¹äºå¤§æ•°å€¼ï¼Œä½¿ç”¨å€æ•°æ˜¾ç¤ºè€Œä¸æ˜¯ç™¾åˆ†æ¯”
            if (bonus >= 100) {
                bonusElement.textContent = formatNumber(bonus) + 'å€';
            } else {
                bonusElement.textContent = (bonus * 100).toFixed(2) + '%';
            }
        }
    }
}

// è®¡ç®—é•¶åµŒå¢ç›Š
function calculateEmbeddingBonus(blockIndex) {
    const block = gameData.embeddingBlocks[blockIndex - 1];
    if (!block) return 1;
    
    // åªè®¡ç®—åŸºç¡€çš„æŒ‡æ•°å¢ç›Šï¼Œä¸å†å åŠ å…¶ä»–åŒºå—çš„å¢ç›Š
    const baseBonus = Math.pow(block.count + 1, block.exponent);
    
    return baseBonus;
}

// å®šä¹‰updateStatsDisplayå‡½æ•°ï¼Œæ›´æ–°æ¸¸æˆç»Ÿè®¡æ˜¾ç¤º
function updateStatsDisplay() {
    // æ›´æ–°å¥‡ç‚¹æ˜¾ç¤º
    const singularityElement = document.getElementById('embedding-singularity-count');
    if (singularityElement) {
        singularityElement.textContent = formatNumber(gameData.singularity);
    }
    
    // è°ƒç”¨updateStatsæ›´æ–°å…¶ä»–ç»Ÿè®¡ä¿¡æ¯
    updateStats();
}

// æ‰§è¡Œé•¶åµŒ
function performEmbedding(blockIndex, amount = 1) {
    if (gameData.singularity < amount) {
        alert('å¥‡ç‚¹æ•°é‡ä¸è¶³ï¼');
        return false;
    }
    
    gameData.singularity -= amount;
    gameData.embeddingBlocks[blockIndex - 1].count += amount;
    updateEmbeddingDisplay();
    updateStatsDisplay();
    return true;
}

// é‡ç½®é•¶åµŒ
function resetEmbedding() {
    if (gameData.singularity === 0 && gameData.embeddingBlocks.every(block => block.count === 0)) {
        alert('æ²¡æœ‰é•¶åµŒçš„å¥‡ç‚¹å¯é‡ç½®ï¼');
        return;
    }
    
    if (!confirm('ç¡®å®šè¦é‡ç½®æ‰€æœ‰é•¶åµŒå—ï¼Ÿè¿™å°†è¿”è¿˜80%çš„å¥‡ç‚¹ã€‚')) {
        return;
    }
    
    let totalSingularity = 0;
    for (let block of gameData.embeddingBlocks) {
        totalSingularity += block.count;
        block.count = 0;
    }
    
    gameData.singularity += Math.floor(totalSingularity * 0.8);
    updateEmbeddingDisplay();
    updateStatsDisplay();
}

function performForging() {
            // è·å–è¾“å…¥çš„ç»“æ™¶æ•°é‡
            const crystalValue = parseInt(forgingCrystalValueElement.value);
            
            // éªŒè¯è¾“å…¥
            if (isNaN(crystalValue) || crystalValue < 1) {
                forgingResultElement.textContent = "è¯·è¾“å…¥æœ‰æ•ˆçš„ç»“æ™¶æ•°é‡ï¼";
                return;
            }
            
            // æ£€æŸ¥ç»“æ™¶æ•°é‡æ˜¯å¦è¶³å¤Ÿ
            if (gameData.alchemyCrystals < crystalValue) {
                forgingResultElement.textContent = "ç»“æ™¶æ•°é‡ä¸è¶³ï¼";
                return;
            }
            
            // æ¶ˆè€—ç»“æ™¶
            gameData.alchemyCrystals -= crystalValue;
            
            // è®¡ç®—å››ä¸ªéšæœºè¯æ¡ï¼ˆé—­åŒºé—´å†…éšæœºï¼‰
            const damageBonus = calculateForgingBonus(crystalValue * 50, 20 * crystalValue);
            const usageBonusGain = calculateForgingBonus(crystalValue * 10, 4 * crystalValue);
            const goldGain = calculateForgingBonus(crystalValue * 5, 2 * crystalValue);
            const crystalBonusGain = calculateForgingBonus(crystalValue * 2.5, crystalValue);
            
            // æ›´æ–°æ·¬ç‚¼å±æ€§
            gameData.forgingStats.damageBonus += damageBonus;
            gameData.forgingStats.usageBonusGain += usageBonusGain;
            gameData.forgingStats.goldGain += goldGain;
            gameData.forgingStats.crystalBonusGain += crystalBonusGain;
            
            // æ˜¾ç¤ºæ·¬ç‚¼ç»“æœ
            forgingResultElement.innerHTML = `
                æ·¬ç‚¼æˆåŠŸï¼æ¶ˆè€—äº† ${crystalValue} ä¸ªç‚¼è¯ç»“æ™¶<br>
                è·å¾—å±æ€§ï¼š<br>
                1. ä¼¤å®³å¢ç›Š +${damageBonus.toFixed(2)}%<br>
                2. æ¯æ¬¡æ”»å‡»è·å¾—ä½¿ç”¨å¢ç›Š +${usageBonusGain.toFixed(2)}%<br>
                3. æ¯æ¬¡è·å¾—é‡‘å¸ +${goldGain.toFixed(2)}%<br>
                4. ç»“æ™¶æ–¹å—è·å¾—ç‚¼è¯å¢ç›Š +${crystalBonusGain.toFixed(2)}%
            `;
            
            // æ›´æ–°æ¸¸æˆç»Ÿè®¡
            updateStats();
            
            // ä¿å­˜æ¸¸æˆ
            autoSaveGame();
        }
        
        // è®¡ç®—æ·¬ç‚¼éšæœºå¢ç›Šï¼ˆé—­åŒºé—´ï¼‰
        function calculateForgingBonus(base, variance) {
            const min = base - variance;
            const max = base + variance;
            return Math.max(0, Math.random() * (max - min) + min);
        }
        
        // åˆ›å»ºèƒ½é‡å€é€Ÿæå‡é€šçŸ¥
        function createEnergyMultiplierNotification(amount) {
            const energyElementRef = document.getElementById('energy');
            if (energyElementRef) {
                const notification = document.createElement('div');
                notification.textContent = `+${amount} èƒ½é‡å€é€Ÿ`;
                notification.style.position = 'absolute';
                notification.style.color = '#4CAF50';
                notification.style.fontWeight = 'bold';
                notification.style.fontSize = '14px';
                notification.style.zIndex = '1000';
                notification.style.pointerEvents = 'none';
                
                const rect = energyElementRef.getBoundingClientRect();
                notification.style.left = `${rect.left + rect.width / 2}px`;
                notification.style.top = `${rect.top}px`;
                document.body.appendChild(notification);
                
                // åŠ¨ç”»æ•ˆæœ
                let pos = 0;
                const interval = setInterval(() => {
                    pos += 1;
                    notification.style.transform = `translate(-50%, -${pos}px)`;
                    if (pos > 50) {
                        clearInterval(interval);
                        document.body.removeChild(notification);
                    }
                }, 10);
            }
        }
        
        // è½¬åŒ–èƒ½é‡åŠŸèƒ½
        function convertEnergy() {
            const matterCost = 1000000; // 100ä¸‡ç‰©è´¨
            if (gameData.matter >= matterCost) {
                gameData.matter -= matterCost;
                gameData.energyMultiplier += 1; // æ¯100ä¸‡ç‰©è´¨æå‡1èƒ½é‡å€é€Ÿ
                updateStats();
                createEnergyMultiplierNotification(1);
            }
        }
        
        // ä¸€é”®æå‡èƒ½é‡å€é€ŸåŠŸèƒ½
        function convertEnergyMax() {
            const matterCost = 1000000; // 100ä¸‡ç‰©è´¨
            const maxUpgrades = Math.floor(gameData.matter / matterCost);
            if (maxUpgrades > 0) {
                gameData.matter -= maxUpgrades * matterCost;
                gameData.energyMultiplier += maxUpgrades;
                updateStats();
                createEnergyMultiplierNotification(maxUpgrades);
            }
        }
        
        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬å™¨
        mineBlockElement.addEventListener('click', mineBlock);
        prevBlockButton.addEventListener('click', prevBlock);
        nextBlockButton.addEventListener('click', nextBlock);
        toggleBlockTypeButton.addEventListener('click', toggleBlockType);
        miningTabButton.addEventListener('click', () => switchTab('mining'));
        alchemyTabButton.addEventListener('click', () => switchTab('alchemy'));
        if (forgingTabButton) forgingTabButton.addEventListener('click', () => switchTab('forging'));
        if (embeddingTabButton) embeddingTabButton.addEventListener('click', () => switchTab('embedding'));
        if (forgingButtonElement) forgingButtonElement.addEventListener('click', performForging);
        batchAlchemyButtonElement.addEventListener('click', performBatchAlchemy);
        convertEnergyButton.addEventListener('click', convertEnergy);
convertEnergyMaxButton.addEventListener('click', convertEnergyMax);
        
        // å®šä¹‰embedSingularityå‡½æ•°ï¼Œç”¨äºHTMLä¸­çš„onclickè°ƒç”¨
        window.embedSingularity = function(blockIndex) {
            const input = document.getElementById(`embedding-input-${blockIndex}`);
            const amount = parseInt(input.value) || 1;
            performEmbedding(blockIndex + 1, amount); // è½¬æ¢ä¸ºä»1å¼€å§‹çš„ç´¢å¼•
        }
        
        // æ·»åŠ é‡ç½®é•¶åµŒæŒ‰é’®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
        const embeddingSystem = document.querySelector('.embedding-system');
        if (embeddingSystem && !document.getElementById('embedding-reset-button')) {
            const resetButton = document.createElement('button');
            resetButton.id = 'embedding-reset-button';
            resetButton.className = 'alchemy-btn';
            resetButton.textContent = 'é‡ç½®é•¶åµŒï¼ˆè¿”è¿˜80%å¥‡ç‚¹ï¼‰';
            resetButton.addEventListener('click', resetEmbedding);
            embeddingSystem.appendChild(resetButton);
        }
        
        // é‡ç½®é•¶åµŒæŒ‰é’®äº‹ä»¶ç›‘å¬
        const resetButton = document.getElementById('embedding-reset-button');
        if (resetButton) {
            resetButton.addEventListener('click', resetEmbedding);
        }
        document.getElementById('crystallize-btn').addEventListener('click', createAlchemyCrystals);

        // è®¾ç½®æ¯5ç§’è‡ªåŠ¨ä¿å­˜
        setInterval(autoSaveGame, 5000);

        // é¡µé¢å…³é—­å‰ä¿å­˜
        window.addEventListener('beforeunload', autoSaveGame);

        // å°è¯•åŠ è½½å­˜æ¡£
        loadGame();

        // é‡ç½®æ¸¸æˆå‡½æ•°
        function resetGame() {
            if (confirm('ç¡®å®šè¦é‡ç½®æ¸¸æˆå—ï¼Ÿè¿™å°†æ¸…é™¤æ‰€æœ‰æ¸¸æˆæ•°æ®ï¼Œæ— æ³•æ¢å¤ï¼')) {
                // é‡ç½®æ‰€æœ‰æ¸¸æˆæ•°æ®
                gameData.gold = 0;
                gameData.currentPickaxeIndex = 0;
                gameData.currentBlockIndex = 0;
                gameData.currentAlchemyBlockIndex = 0;
                gameData.currentSpecialBlockIndex = 0;
                gameData.usageBonus = 1;
                gameData.alchemyBonus = 1;
                gameData.alchemyPoints = 0;
                gameData.alchemyCrystals = 0;
                gameData.iridiumIngots = 0;
                gameData.hassiumIngots = 0;
                gameData.singularity = 0;
                gameData.matter = 0;
                gameData.energy = 0;
                gameData.energyMultiplier = 0;
                gameData.productionCore = 0;
                gameData.endCore = 0;
                gameData.ownedPickaxes = [0];
                gameData.currentBlockType = 'normal';
                gameData.autoMiningEnabled = false;
                gameData.miningCount = 0;
                gameData.miningPerSecond = 0;
                
                // é‡ç½®æ·¬ç‚¼å±æ€§
                gameData.forgingStats = {
                    damageBonus: 0,
                    usageBonusGain: 0,
                    goldGain: 0,
                    crystalBonusGain: 0
                };
                
                // é‡ç½®é•¶åµŒç³»ç»Ÿæ•°æ®
                gameData.embeddingBlocks = [
                    { count: 0, exponent: 0.36, name: 'æ”»å‡»å¢ç›Š' },
                    { count: 0, exponent: 0.28, name: 'ç‚¼è¯å€¼è·å–å¢ç›Š' },
                    { count: 0, exponent: 0.24, name: 'ä½¿ç”¨å¢ç›Šè·å–å¢ç›Š' },
                    { count: 0, exponent: 0.2, name: 'é‡‘å¸è·å–å¢ç›Š' },
                    { count: 0, exponent: 0.16, name: 'å…¨å±æ€§å¢ç›Š' }
                ];
                
                // é‡ç½®å½“å‰æ–¹å—
                currentBlock = JSON.parse(JSON.stringify(blocks[0]));
                currentBlock.maxHealth = currentBlock.health;
                
                // æ›´æ–°UI
                updateStats();
                updateStatsDisplay();
                updatePickaxeList();
                updateBlockDisplay();
                
                // æ¸…é™¤å­˜æ¡£
                localStorage.removeItem('miningGameSave');
                localStorage.removeItem('miningGameData');
                
                // é‡ç½®æˆå°±æ•°æ®
                gameData.achievements = [];
                gameData.completedAchievements = {};
                
                alert('æ¸¸æˆå·²é‡ç½®ï¼');
            }
        }
        
        // é‡ç½®æŒ‰é’®äº‹ä»¶ç›‘å¬
        document.getElementById('reset-game-btn').addEventListener('click', resetGame);
        
        // ä¿å­˜æ¸¸æˆæ•°æ®
        function saveGame() {
            localStorage.setItem('miningGameData', JSON.stringify(gameData));
        }
        
        // åŠ è½½æ¸¸æˆæ•°æ®
        function loadGame() {
            const savedData = localStorage.getItem('miningGameData') || localStorage.getItem('miningGameSave');
            if (savedData) {
                try {
                    const parsedData = JSON.parse(savedData);
                    Object.assign(gameData, parsedData);
                    
                    // ç¡®ä¿æˆå°±ç›¸å…³æ•°æ®å­˜åœ¨
                    if (!gameData.achievements) {
                        gameData.achievements = [];
                    }
                    if (!gameData.completedAchievements) {
                        gameData.completedAchievements = {};
                    }
                } catch (e) {
                    console.error('åŠ è½½æ¸¸æˆæ•°æ®å¤±è´¥:', e);
                }
            }
        }
        
        // è‡ªåŠ¨ä¿å­˜
        function autoSaveGame() {
            saveGame();
        }
        
        // åˆå§‹åŒ–æ¸¸æˆ
        currentBlock.maxHealth = currentBlock.health;
        
        // åˆå§‹åŒ–æˆå°±ç³»ç»Ÿ
        if (window.initAchievements) {
            initAchievements();
        }
        
        updateStats();
        updateStatsDisplay(); // ç¡®ä¿å¥‡ç‚¹æ•°é‡æ­£ç¡®æ˜¾ç¤º
    </script>
</body>
</html>